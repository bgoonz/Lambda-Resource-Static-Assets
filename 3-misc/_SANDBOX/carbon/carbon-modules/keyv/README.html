<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 align="center">
<img width="250" src="https://rawgit.com/lukechilds/keyv/master/media/logo.svg" alt="keyv"> <br> <br>
</h1>
<blockquote>
<p>Simple key-value storage with support for multiple backends</p>
</blockquote>
<p><a href="https://travis-ci.org/lukechilds/keyv"><img src="https://travis-ci.org/lukechilds/keyv.svg?branch=master" alt="Build Status" /></a> <a href="https://coveralls.io/github/lukechilds/keyv?branch=master"><img src="https://coveralls.io/repos/github/lukechilds/keyv/badge.svg?branch=master" alt="Coverage Status" /></a> <a href="https://www.npmjs.com/package/keyv"><img src="https://img.shields.io/npm/dm/keyv.svg" alt="npm" /></a> <a href="https://www.npmjs.com/package/keyv"><img src="https://img.shields.io/npm/v/keyv.svg" alt="npm" /></a></p>
<p>Keyv provides a consistent interface for key-value storage across multiple backends via storage adapters. It supports TTL based expiry, making it suitable as a cache or a persistent key-value store.</p>
<h2 id="features">Features</h2>
<p>There are a few existing modules similar to Keyv, however Keyv is different because it:</p>
<ul>
<li>Isn’t bloated</li>
<li>Has a simple Promise based API</li>
<li>Suitable as a TTL based cache or persistent key-value store</li>
<li><a href="#add-cache-support-to-your-module">Easily embeddable</a> inside another module</li>
<li>Works with any storage that implements the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map"><code>Map</code></a> API</li>
<li>Handles all JSON types plus <code>Buffer</code></li>
<li>Supports namespaces</li>
<li>Wide range of <a href="#official-storage-adapters"><strong>efficient, well tested</strong></a> storage adapters</li>
<li>Connection errors are passed through (db failures won’t kill your app)</li>
<li>Supports the current active LTS version of Node.js or higher</li>
</ul>
<h2 id="usage">Usage</h2>
<p>Install Keyv.</p>
<pre><code>npm install --save keyv</code></pre>
<p>By default everything is stored in memory, you can optionally also install a storage adapter.</p>
<pre><code>npm install --save @keyv/redis
npm install --save @keyv/mongo
npm install --save @keyv/sqlite
npm install --save @keyv/postgres
npm install --save @keyv/mysql</code></pre>
<p>Create a new Keyv instance, passing your connection string if applicable. Keyv will automatically load the correct storage adapter.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">const</span> Keyv <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;keyv&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">// One of the following</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">const</span> keyv <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">const</span> keyv <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="st">&#39;redis://user:pass@localhost:6379&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="kw">const</span> keyv <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="st">&#39;mongodb://user:pass@localhost:27017/dbname&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">const</span> keyv <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="st">&#39;sqlite://path/to/database.sqlite&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="kw">const</span> keyv <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="st">&#39;postgresql://user:pass@localhost:5432/dbname&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="kw">const</span> keyv <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="st">&#39;mysql://user:pass@localhost:3306/dbname&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-10" title="10"></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">// Handle DB connection errors</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="va">keyv</span>.<span class="at">on</span>(<span class="st">&#39;error&#39;</span><span class="op">,</span> err <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Connection Error&#39;</span><span class="op">,</span> err))<span class="op">;</span></a>
<a class="sourceLine" id="cb3-13" title="13"></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="cf">await</span> <span class="va">keyv</span>.<span class="at">set</span>(<span class="st">&#39;foo&#39;</span><span class="op">,</span> <span class="st">&#39;expires in 1 second&#39;</span><span class="op">,</span> <span class="dv">1000</span>)<span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="cf">await</span> <span class="va">keyv</span>.<span class="at">set</span>(<span class="st">&#39;foo&#39;</span><span class="op">,</span> <span class="st">&#39;never expires&#39;</span>)<span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="cf">await</span> <span class="va">keyv</span>.<span class="at">get</span>(<span class="st">&#39;foo&#39;</span>)<span class="op">;</span> <span class="co">// &#39;never expires&#39;</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="cf">await</span> <span class="va">keyv</span>.<span class="at">delete</span>(<span class="st">&#39;foo&#39;</span>)<span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="cf">await</span> <span class="va">keyv</span>.<span class="at">clear</span>()<span class="op">;</span> <span class="co">// undefined</span></a></code></pre></div>
<h3 id="namespaces">Namespaces</h3>
<p>You can namespace your Keyv instance to avoid key collisions and allow you to clear only a certain namespace while using the same database.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">const</span> users <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="st">&#39;redis://user:pass@localhost:6379&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">namespace</span><span class="op">:</span> <span class="st">&#39;users&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">const</span> cache <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="st">&#39;redis://user:pass@localhost:6379&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">namespace</span><span class="op">:</span> <span class="st">&#39;cache&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="cf">await</span> <span class="va">users</span>.<span class="at">set</span>(<span class="st">&#39;foo&#39;</span><span class="op">,</span> <span class="st">&#39;users&#39;</span>)<span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="cf">await</span> <span class="va">cache</span>.<span class="at">set</span>(<span class="st">&#39;foo&#39;</span><span class="op">,</span> <span class="st">&#39;cache&#39;</span>)<span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="cf">await</span> <span class="va">users</span>.<span class="at">get</span>(<span class="st">&#39;foo&#39;</span>)<span class="op">;</span> <span class="co">// &#39;users&#39;</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="cf">await</span> <span class="va">cache</span>.<span class="at">get</span>(<span class="st">&#39;foo&#39;</span>)<span class="op">;</span> <span class="co">// &#39;cache&#39;</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="cf">await</span> <span class="va">users</span>.<span class="at">clear</span>()<span class="op">;</span> <span class="co">// undefined</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="cf">await</span> <span class="va">users</span>.<span class="at">get</span>(<span class="st">&#39;foo&#39;</span>)<span class="op">;</span> <span class="co">// undefined</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="cf">await</span> <span class="va">cache</span>.<span class="at">get</span>(<span class="st">&#39;foo&#39;</span>)<span class="op">;</span> <span class="co">// &#39;cache&#39;</span></a></code></pre></div>
<h3 id="custom-serializers">Custom Serializers</h3>
<p>Keyv uses <a href="https://github.com/dominictarr/json-buffer"><code>json-buffer</code></a> for data serialization to ensure consistency across different backends.</p>
<p>You can optionally provide your own serialization functions to support extra data types or to serialize to something other than JSON.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">const</span> keyv <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="op">{</span> <span class="dt">serialize</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span><span class="op">,</span> <span class="dt">deserialize</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">parse</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p><strong>Warning:</strong> Using custom serializers means you lose any guarantee of data consistency. You should do extensive testing with your serialisation functions and chosen storage engine.</p>
<h2 id="official-storage-adapters">Official Storage Adapters</h2>
<p>The official storage adapters are covered by <a href="https://travis-ci.org/lukechilds/keyv/jobs/260418145">over 150 integration tests</a> to guarantee consistent behaviour. They are lightweight, efficient wrappers over the DB clients making use of indexes and native TTLs where available.</p>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Database</th>
<th>Adapter</th>
<th>Native TTL</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Redis</td>
<td><span class="citation" data-cites="keyv/redis">[@keyv/redis]</span>(https://github.com/lukechilds/keyv-redis)</td>
<td>Yes</td>
<td><a href="https://travis-ci.org/lukechilds/keyv-redis"><img src="https://travis-ci.org/lukechilds/keyv-redis.svg?branch=master" alt="Build Status" /></a> <a href="https://coveralls.io/github/lukechilds/keyv-redis?branch=master"><img src="https://coveralls.io/repos/github/lukechilds/keyv-redis/badge.svg?branch=master" alt="Coverage Status" /></a></td>
</tr>
<tr class="even">
<td>MongoDB</td>
<td><span class="citation" data-cites="keyv/mongo">[@keyv/mongo]</span>(https://github.com/lukechilds/keyv-mongo)</td>
<td>Yes</td>
<td><a href="https://travis-ci.org/lukechilds/keyv-mongo"><img src="https://travis-ci.org/lukechilds/keyv-mongo.svg?branch=master" alt="Build Status" /></a> <a href="https://coveralls.io/github/lukechilds/keyv-mongo?branch=master"><img src="https://coveralls.io/repos/github/lukechilds/keyv-mongo/badge.svg?branch=master" alt="Coverage Status" /></a></td>
</tr>
<tr class="odd">
<td>SQLite</td>
<td><span class="citation" data-cites="keyv/sqlite">[@keyv/sqlite]</span>(https://github.com/lukechilds/keyv-sqlite)</td>
<td>No</td>
<td><a href="https://travis-ci.org/lukechilds/keyv-sqlite"><img src="https://travis-ci.org/lukechilds/keyv-sqlite.svg?branch=master" alt="Build Status" /></a> <a href="https://coveralls.io/github/lukechilds/keyv-sqlite?branch=master"><img src="https://coveralls.io/repos/github/lukechilds/keyv-sqlite/badge.svg?branch=master" alt="Coverage Status" /></a></td>
</tr>
<tr class="even">
<td>PostgreSQL</td>
<td><span class="citation" data-cites="keyv/postgres">[@keyv/postgres]</span>(https://github.com/lukechilds/keyv-postgres)</td>
<td>No</td>
<td><a href="https://travis-ci.org/lukechildskeyv-postgreskeyv"><img src="https://travis-ci.org/lukechilds/keyv-postgres.svg?branch=master" alt="Build Status" /></a> <a href="https://coveralls.io/github/lukechilds/keyv-postgres?branch=master"><img src="https://coveralls.io/repos/github/lukechilds/keyv-postgres/badge.svg?branch=master" alt="Coverage Status" /></a></td>
</tr>
<tr class="odd">
<td>MySQL</td>
<td><span class="citation" data-cites="keyv/mysql">[@keyv/mysql]</span>(https://github.com/lukechilds/keyv-mysql)</td>
<td>No</td>
<td><a href="https://travis-ci.org/lukechilds/keyv-mysql"><img src="https://travis-ci.org/lukechilds/keyv-mysql.svg?branch=master" alt="Build Status" /></a> <a href="https://coveralls.io/github/lukechilds/keyv-mysql?branch=master"><img src="https://coveralls.io/repos/github/lukechilds/keyv-mysql/badge.svg?branch=master" alt="Coverage Status" /></a></td>
</tr>
</tbody>
</table>
<h2 id="third-party-storage-adapters">Third-party Storage Adapters</h2>
<p>You can also use third-party storage adapters or build your own. Keyv will wrap these storage adapters in TTL functionality and handle complex types internally.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">const</span> Keyv <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;keyv&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">const</span> myAdapter <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;./my-storage-adapter&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">const</span> keyv <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="op">{</span> <span class="dt">store</span><span class="op">:</span> myAdapter <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Any store that follows the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map"><code>Map</code></a> api will work.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">new</span> <span class="at">Keyv</span>(<span class="op">{</span> <span class="dt">store</span><span class="op">:</span> <span class="kw">new</span> <span class="at">Map</span>() <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>For example, <a href="https://github.com/sindresorhus/quick-lru"><code>quick-lru</code></a> is a completely unrelated module that implements the Map API.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">const</span> Keyv <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;keyv&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">const</span> QuickLRU <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;quick-lru&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-3" title="3"></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">const</span> lru <span class="op">=</span> <span class="kw">new</span> <span class="at">QuickLRU</span>(<span class="op">{</span> <span class="dt">maxSize</span><span class="op">:</span> <span class="dv">1000</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw">const</span> keyv <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="op">{</span> <span class="dt">store</span><span class="op">:</span> lru <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>The following are third-party storage adapters compatible with Keyv:</p>
<ul>
<li><a href="https://github.com/sindresorhus/quick-lru">quick-lru</a> - Simple “Least Recently Used” (LRU) cache</li>
<li><a href="https://github.com/zaaack/keyv-file">keyv-file</a> - File system storage adapter for Keyv</li>
<li><a href="https://www.npmjs.com/package/keyv-dynamodb">keyv-dynamodb</a> - DynamoDB storage adapter for Keyv</li>
<li><a href="https://github.com/goto-bus-stop/keyv-firestore">keyv-firestore</a> – Firebase Cloud Firestore adapter for Keyv</li>
<li><a href="https://github.com/pmorgan3/keyv-mssql">keyv-mssql</a> - Microsoft Sql Server adapter for Keyv</li>
<li><a href="https://github.com/jaredwray/keyv-memcache">keyv-memcache</a> - Memcache storage adapter for Keyv</li>
</ul>
<h2 id="add-cache-support-to-your-module">Add Cache Support to your Module</h2>
<p>Keyv is designed to be easily embedded into other modules to add cache support. The recommended pattern is to expose a <code>cache</code> option in your modules options which is passed through to Keyv. Caching will work in memory by default and users have the option to also install a Keyv storage adapter and pass in a connection string, or any other storage that implements the <code>Map</code> API.</p>
<p>You should also set a namespace for your module so you can safely call <code>.clear()</code> without clearing unrelated app data.</p>
<p>Inside your module:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">class</span> AwesomeModule <span class="op">{</span></a>
<a class="sourceLine" id="cb9-2" title="2">    <span class="at">constructor</span>(opts) <span class="op">{</span></a>
<a class="sourceLine" id="cb9-3" title="3">        <span class="kw">this</span>.<span class="at">cache</span> <span class="op">=</span> <span class="kw">new</span> <span class="at">Keyv</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb9-4" title="4">            <span class="dt">uri</span><span class="op">:</span> <span class="kw">typeof</span> <span class="va">opts</span>.<span class="at">cache</span> <span class="op">===</span> <span class="st">&#39;string&#39;</span> <span class="op">&amp;&amp;</span> <span class="va">opts</span>.<span class="at">cache</span><span class="op">,</span></a>
<a class="sourceLine" id="cb9-5" title="5">            <span class="dt">store</span><span class="op">:</span> <span class="kw">typeof</span> <span class="va">opts</span>.<span class="at">cache</span> <span class="op">!==</span> <span class="st">&#39;string&#39;</span> <span class="op">&amp;&amp;</span> <span class="va">opts</span>.<span class="at">cache</span><span class="op">,</span></a>
<a class="sourceLine" id="cb9-6" title="6">            <span class="dt">namespace</span><span class="op">:</span> <span class="st">&#39;awesome-module&#39;</span></a>
<a class="sourceLine" id="cb9-7" title="7">        <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-8" title="8">    <span class="op">}</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="op">}</span></a></code></pre></div>
<p>Now it can be consumed like this:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">const</span> AwesomeModule <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;awesome-module&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">// Caches stuff in memory by default</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw">const</span> awesomeModule <span class="op">=</span> <span class="kw">new</span> <span class="at">AwesomeModule</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb10-5" title="5"></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">// After npm install --save keyv-redis</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="kw">const</span> awesomeModule <span class="op">=</span> <span class="kw">new</span> <span class="at">AwesomeModule</span>(<span class="op">{</span> <span class="dt">cache</span><span class="op">:</span> <span class="st">&#39;redis://localhost&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">// Some third-party module that implements the Map API</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="kw">const</span> awesomeModule <span class="op">=</span> <span class="kw">new</span> <span class="at">AwesomeModule</span>(<span class="op">{</span> <span class="dt">cache</span><span class="op">:</span> some3rdPartyStore <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="api">API</h2>
<h3 id="new-keyvuri-options">new Keyv(<a href="#uri">uri</a>, <a href="#options">options</a>)</h3>
<p>Returns a new Keyv instance.</p>
<p>The Keyv instance is also an <code>EventEmitter</code> that will emit an <code>'error'</code> event if the storage adapter connection fails.</p>
<h3 id="uri">uri</h3>
<p>Type: <code>String</code><br> Default: <code>undefined</code></p>
<p>The connection string URI.</p>
<p>Merged into the options object as options.uri.</p>
<h3 id="options">options</h3>
<p>Type: <code>Object</code></p>
<p>The options object is also passed through to the storage adapter. Check your storage adapter docs for any extra options.</p>
<h4 id="options.namespace">options.namespace</h4>
<p>Type: <code>String</code><br> Default: <code>'keyv'</code></p>
<p>Namespace for the current instance.</p>
<h4 id="options.ttl">options.ttl</h4>
<p>Type: <code>Number</code><br> Default: <code>undefined</code></p>
<p>Default TTL. Can be overridden by specififying a TTL on <code>.set()</code>.</p>
<h4 id="options.serialize">options.serialize</h4>
<p>Type: <code>Function</code><br> Default: <code>JSONB.stringify</code></p>
<p>A custom serialization function.</p>
<h4 id="options.deserialize">options.deserialize</h4>
<p>Type: <code>Function</code><br> Default: <code>JSONB.parse</code></p>
<p>A custom deserialization function.</p>
<h4 id="options.store">options.store</h4>
<p>Type: <code>Storage adapter instance</code><br> Default: <code>new Map()</code></p>
<p>The storage adapter instance to be used by Keyv.</p>
<h4 id="options.adapter">options.adapter</h4>
<p>Type: <code>String</code><br> Default: <code>undefined</code></p>
<p>Specify an adapter to use. e.g <code>'redis'</code> or <code>'mongodb'</code>.</p>
<h3 id="instance">Instance</h3>
<p>Keys must always be strings. Values can be of any type.</p>
<h4 id="setkey-value-ttl">.set(key, value, [ttl])</h4>
<p>Set a value.</p>
<p>By default keys are persistent. You can set an expiry TTL in milliseconds.</p>
<p>Returns a promise which resolves to <code>true</code>.</p>
<h4 id="getkey-options">.get(key, <a href="#options">options</a>)</h4>
<p>Returns a promise which resolves to the retrieved value.</p>
<h5 id="options.raw">options.raw</h5>
<p>Type: <code>Boolean</code><br> Default: <code>false</code></p>
<p>If set to true the raw DB object Keyv stores internally will be returned instead of just the value.</p>
<p>This contains the TTL timestamp.</p>
<h4 id="deletekey">.delete(key)</h4>
<p>Deletes an entry.</p>
<p>Returns a promise which resolves to <code>true</code> if the key existed, <code>false</code> if not.</p>
<h4 id="clear">.clear()</h4>
<p>Delete all entries in the current namespace.</p>
<p>Returns a promise which is resolved when the entries have been cleared.</p>
<h2 id="license">License</h2>
<p>MIT © Luke Childs</p>
</body>
</html>
