<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README.zh-tw</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="ç€è¦½å™¨æ“´å……åŠŸèƒ½å°ˆæ¡ˆ-part-1å‘¼å«-apiä½¿ç”¨-local-storage">ç€è¦½å™¨æ“´å……åŠŸèƒ½å°ˆæ¡ˆ Part 1ï¼šå‘¼å« APIï¼Œä½¿ç”¨ Local Storage</h1>
<h2 id="èª²å‰æ¸¬é©—">èª²å‰æ¸¬é©—</h2>
<p><a href="https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/25?loc=zh_tw">èª²å‰æ¸¬é©—</a></p>
<h3 id="å¤§ç¶±">å¤§ç¶±</h3>
<p>åœ¨é€™å ‚èª²ä¸­ï¼Œè—‰ç”±å‚³éä½ çš„æ“´å……åŠŸèƒ½è¡¨å–®ä¸¦é¡¯ç¤ºçµæœä¾†å‘¼å« APIã€‚æ­¤å¤–ï¼Œä½ æœƒäº†è§£å¦‚ä½•å„²å­˜è³‡æ–™åˆ°ç€è¦½å™¨çš„ Local Storage ä¸­çµ¦æœªä¾†ä½¿ç”¨ã€‚</p>
<p>âœ… è«‹åƒè€ƒä¸‹åˆ—ç¨‹å¼ç¢¼æ®µï¼ŒåŠ å…¥ç¨‹å¼ç¢¼åˆ°æª”æ¡ˆé©ç•¶çš„ä½ç½®</p>
<h3 id="è¨­å®šæ§åˆ¶æ“´å……åŠŸèƒ½çš„å…ƒç´ ">è¨­å®šæ§åˆ¶æ“´å……åŠŸèƒ½çš„å…ƒç´ ï¼š</h3>
<p>ç¾åœ¨ä½ æœ‰å·²å»ºå¥½çš„ HTML è¡¨å–®èˆ‡çµæœå€ <code>&lt;div&gt;</code>ã€‚æ¥ä¸‹ä¾†ï¼Œä½ éœ€è¦åœ¨ <code>/src/index.js</code> åšä¸€äº›è™•ç†ï¼Œä¸€é»ä¸€é»åœ°æ§‹ç¯‰å‡ºä½ çš„æ“´å……åŠŸèƒ½ã€‚åƒè€ƒ<a href="../../1-about-browsers/translations/README.zh-tw.md">å‰ä¸€å ‚èª²ç¨‹</a>ä¾†è¨­ç½®ä½ çš„å°ˆæ¡ˆèˆ‡äº†è§£å»ºåˆ¶éç¨‹ã€‚</p>
<p>è™•ç† <code>index.js</code> æª”æ¡ˆï¼Œå»ºç«‹ä¸€äº› <code>const</code> è®Šæ•¸ä¾†å„²å­˜ä¸åŒç”¨é€”çš„æ•¸å€¼ï¼š</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="co">// è¡¨å–®å€åŸŸ</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">const</span> form <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.form-data&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">const</span> region <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.region-name&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">const</span> apiKey <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.api-key&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">// çµæœå€åŸŸ</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">const</span> errors <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.errors&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">const</span> loading <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.loading&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">const</span> results <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.result-container&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">const</span> usage <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.carbon-usage&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">const</span> fossilfuel <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.fossil-fuel&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">const</span> myregion <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.my-region&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">const</span> clearBtn <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.clear-btn&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>é€™äº›å€åŸŸæœƒè¢« CSS class çµ¦åƒè€ƒï¼Œå®ƒå€‘åœ¨å‰ä¸€å ‚èª²ä¸­å·²ç¶“è¢«ä½ è¨­å®šå¥½äº†ã€‚</p>
<h3 id="æ–°å¢ç›£è½è€…">æ–°å¢ç›£è½è€…</h3>
<p>æ¥ä¸‹ä¾†ï¼Œæ–°å¢æäº¤èˆ‡é‡ç½®è¡¨å–®çš„äº‹ä»¶ç›£è½è€…èˆ‡æŒ‰éˆ•ï¼Œè®“ä½¿ç”¨è€…èƒ½æäº¤è¡¨å–®æˆ–æ˜¯é»æ“Šé‡ç½®éˆ•æ™‚ï¼Œäº‹ä»¶æœƒç™¼ç”Ÿã€‚æ–°å¢åˆå§‹åŒ–å‘¼å«è™•ç†åˆ°æ‡‰ç”¨ä¸­ï¼Œåœ¨æª”æ¡ˆçš„æœ€ä¸‹æ–¹æ–°å¢ï¼š</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="va">form</span>.<span class="at">addEventListener</span>(<span class="st">&#39;submit&#39;</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> <span class="at">handleSubmit</span>(e))<span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="va">clearBtn</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> <span class="at">reset</span>(e))<span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="at">init</span>()<span class="op">;</span></a></code></pre></div>
<p>âœ… æ³¨æ„æäº¤äº‹ä»¶èˆ‡é»æ“Šäº‹ä»¶çš„å¯«æ³•ï¼Œäº‹ä»¶æ˜¯å¦‚ä½•è¢«å‚³å…¥åˆ° handleSubmit æˆ–æ˜¯ reset å‡½å¼ä¸­çš„ã€‚ä½ èƒ½åœ¨ä¸æ”¹è®ŠåŠŸèƒ½çš„æƒ…æ³ä¸‹ï¼Œæ”¹å¯«æˆè¼ƒé•·çš„æ ¼å¼å—ï¼Ÿä½ æ¯”è¼ƒå–œæ­¡å“ªä¸€ç¨®å¯«æ³•ï¼Ÿ</p>
<h3 id="å»ºç«‹-init-å‡½å¼èˆ‡-reset-å‡½å¼">å»ºç«‹ init() å‡½å¼èˆ‡ reset() å‡½å¼ï¼š</h3>
<p>ç¾åœ¨ä½ éœ€è¦å»ºç«‹å‡½å¼ init()ï¼Œè™•ç†æ‡‰ç”¨ç¨‹å¼çš„åˆå§‹åŒ–éƒ¨åˆ†ï¼š</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">function</span> <span class="at">init</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">    <span class="co">//å¦‚æœä»»ä½•æ±è¥¿å­˜åœ¨ localStorage ä¸­ï¼Œå–å‡ºä¾†</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="kw">const</span> storedApiKey <span class="op">=</span> <span class="va">localStorage</span>.<span class="at">getItem</span>(<span class="st">&#39;apiKey&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw">const</span> storedRegion <span class="op">=</span> <span class="va">localStorage</span>.<span class="at">getItem</span>(<span class="st">&#39;regionName&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="co">//è¨­å®š icon ç‚ºé€šç”¨ç¶ è‰²</span></a>
<a class="sourceLine" id="cb3-7" title="7">    <span class="co">//todo</span></a>
<a class="sourceLine" id="cb3-8" title="8"></a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="cf">if</span> (storedApiKey <span class="op">===</span> <span class="kw">null</span> <span class="op">||</span> storedRegion <span class="op">===</span> <span class="kw">null</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-10" title="10">        <span class="co">//å¦‚æœæ²’æœ‰ keysï¼Œé¡¯ç¤ºè¡¨å–®</span></a>
<a class="sourceLine" id="cb3-11" title="11">        <span class="va">form</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;block&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-12" title="12">        <span class="va">results</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-13" title="13">        <span class="va">loading</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-14" title="14">        <span class="va">clearBtn</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-15" title="15">        <span class="va">errors</span>.<span class="at">textContent</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-16" title="16">    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-17" title="17">        <span class="co">//localStorage æœ‰ saved keys/regionsï¼Œé¡¯ç¤ºçµæœ</span></a>
<a class="sourceLine" id="cb3-18" title="18">        <span class="at">displayCarbonUsage</span>(storedApiKey<span class="op">,</span> storedRegion)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-19" title="19">        <span class="va">results</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-20" title="20">        <span class="va">form</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-21" title="21">        <span class="va">clearBtn</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;block&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-22" title="22">    <span class="op">}</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="op">};</span></a>
<a class="sourceLine" id="cb3-24" title="24"></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="kw">function</span> <span class="at">reset</span>(e) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-26" title="26">    <span class="va">e</span>.<span class="at">preventDefault</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-27" title="27">    <span class="co">//åªæ¸…é™¤ local storage åœ‹å®¶å€åŸŸä»£ç¢¼</span></a>
<a class="sourceLine" id="cb3-28" title="28">    <span class="va">localStorage</span>.<span class="at">removeItem</span>(<span class="st">&#39;regionName&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-29" title="29">    <span class="at">init</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="op">}</span></a></code></pre></div>
<p>åœ¨å‡½å¼ä¸­ï¼Œæœ‰ä¸€äº›æœ‰è¶£çš„é‚è¼¯ã€‚é–±è®€å®ƒå€‘ï¼Œä½ çœ‹å‡ºç™¼ç”Ÿä»€éº¼äº‹å—ï¼Ÿ</p>
<ul>
<li>å…©å€‹ <code>const</code> è¢«è¨­å®šç‚ºæª¢æŸ¥ç”¨æˆ¶æ˜¯å¦æœ‰å„²å­˜ APIKey èˆ‡åœ‹å®¶å€åŸŸä»£ç¢¼åœ¨ local storage ä¸­ã€‚</li>
<li>è‹¥å…©è€…çš†ç‚º nullï¼Œå°‡é€ å‹è¨­ç‚º â€˜blockâ€™ ä¾†é¡¯ç¤ºè¡¨å–®</li>
<li>éš±è— resultsã€loading èˆ‡ clearBtnï¼Œè¨­å®š error æ–‡å­—ç‚ºç©ºå­—ä¸²</li>
<li>è‹¥å­˜åœ¨ key èˆ‡ä»£ç¢¼ï¼Œé–‹å§‹æ–°çš„æµç¨‹ï¼š
<ul>
<li>å‘¼å« API å–å¾—ç¢³æ’æ”¾è³‡è¨Š</li>
<li>éš±è—çµæœå€åŸŸ</li>
<li>éš±è—è¡¨å–®</li>
<li>é¡¯ç¤ºé‡ç½®æŒ‰éˆ•</li>
</ul></li>
</ul>
<p>åœ¨ä¸‹ä¸€æ­¥ä¹‹å‰ï¼Œä½ å¯ä»¥å­¸ç¿’ä¸€äº›ç€è¦½å™¨çš„é‡è¦æˆå“¡ï¼š<a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage">LocalStorage</a>ã€‚ LocalStorage æ˜¯ç€è¦½å™¨å„²å­˜å­—ä¸²çš„æœ‰æ•ˆæ–¹æ³•ï¼Œä»¥ <code>key-value</code> é…å°å…©å…©ä¸€çµ„ã€‚é€™ç¨®å„²å­˜å‹æ…‹å¯ä»¥è¢« JavaScript ç®¡ç†ä¸¦æ§åˆ¶ç€è¦½å™¨çš„è³‡æ–™ã€‚LocalStorage æ²’æœ‰æœŸé™ï¼Œè€Œå¦ä¸€æ¬¾ç¶²é å„²å­˜ SessionStorage æœƒåœ¨ç€è¦½å™¨é—œé–‰æ™‚æ¸…é™¤å…§å®¹ã€‚ä¸åŒçš„å„²å­˜æ–¹å¼æœ‰å„è‡ªçš„å„ªç¼ºé»ã€‚</p>
<blockquote>
<p>æ³¨æ„ â”€â”€ ä½ çš„ç€è¦½å™¨æ“´å……å¥—ä»¶æœ‰è‡ªå·±çš„ local storageã€‚ä¸»ç€è¦½å™¨è¦–çª—æ˜¯ä¸åŒçš„å€‹é«”ï¼Œå…©è€…æœƒåšå„è‡ªçš„è¡Œç‚ºã€‚</p>
</blockquote>
<p>ä½ è¨­å®š APIKey ç´€éŒ„å­—ä¸²æ•¸å€¼ã€‚ä½ å¯ä»¥åœ¨ Edge ç€è¦½å™¨ä¸Šã€Œæª¢æŸ¥ã€ä¸€å€‹ç¶²é  (å³éµç€è¦½å™¨ä¾†æª¢æŸ¥)ï¼Œåœ¨ Applications æ¨™ç±¤ä¸­è§€å¯Ÿå„²å­˜å€çš„ä½¿ç”¨æƒ…æ³ã€‚</p>
<figure>
<img src="../images/localstorage.png" alt="Local storage å€åŸŸ" /><figcaption>Local storage å€åŸŸ</figcaption>
</figure>
<p>âœ… æƒ³æƒ³é‚£äº›æƒ…æ³ä½ ä¸éœ€è¦å„²å­˜è³‡æ–™åˆ° LocalStorage ä¸­ã€‚ç¸½é«”è€Œè¨€ï¼Œå°‡ API Keys æ”¾åœ¨ LocalStorage æ˜¯å€‹å¾ˆç³Ÿç³•çš„æƒ³æ³•ï¼ä½ çŸ¥é“ç‚ºä»€éº¼å—ï¼Ÿåœ¨æˆ‘å€‘çš„ä¾‹å­ä¸­ï¼Œæˆ‘å€‘çš„æ‡‰ç”¨ç¨‹å¼æ˜¯ä»¥æ•™å­¸ç‚ºç›®çš„ï¼Œä¸¦ä¸æœƒç™¼å¸ƒåœ¨æ‡‰ç”¨ç¨‹å¼å•†åº—ä¸­ï¼Œæ‰€ä»¥æˆ‘å€‘é¸æ“‡æ­¤ä¸­è™•ç†æ–¹å¼ã€‚</p>
<p>ä½ å¯ä»¥ç™¼ç¾ç¶²é  API èƒ½è™•ç† LocalStorageï¼Œä½¿ç”¨ <code>getItem()</code>ã€<code>setItem()</code> æˆ–æ˜¯ <code>removeItem()</code>ã€‚å®ƒå€‘å»£æ³›åœ°æ”¯æ´ä¸åŒçš„ç€è¦½å™¨ã€‚</p>
<p>åœ¨å»ºç«‹å‡½å¼ <code>init()</code> ä¸­çš„å‡½å¼ <code>displayCarbonUsage()</code> ä¹‹å‰ï¼Œæˆ‘å€‘å…ˆå»ºç«‹è¡¨å–®æäº¤åˆå§‹åŒ–çš„åŠŸèƒ½ã€‚</p>
<h3 id="è™•ç†è¡¨å–®æäº¤">è™•ç†è¡¨å–®æäº¤</h3>
<p>å»ºç«‹å‡½å¼ <code>handleSubmit</code>ï¼Œæ¥æ”¶äº‹ä»¶åƒæ•¸ <code>(e)</code>ã€‚çµ‚æ­¢ç¶²é ç§»è½‰çš„äº‹ä»¶(åœ¨æœ¬ä¾‹å­ä¸­ï¼Œæˆ‘å€‘çµ‚æ­¢ç€è¦½å™¨åˆ·æ–°çš„è™•ç†)ä¸¦å‘¼å«æ–°çš„å‡½å¼ <code>setUpUser</code>ï¼Œå‚³é€åƒæ•¸ <code>apiKey.value</code> èˆ‡ <code>region.value</code>ã€‚è—‰ç”±é€™å€‹æ–¹å¼ï¼Œä½ èƒ½å°‡å…©å€‹åˆå§‹è¡¨å–®çš„æ•¸å€¼æ­£ç¢ºåœ°ç§»è½‰åˆ°é©åˆçš„ä½ç½®ã€‚</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">function</span> <span class="at">handleSubmit</span>(e) <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">    <span class="va">e</span>.<span class="at">preventDefault</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="at">setUpUser</span>(<span class="va">apiKey</span>.<span class="at">value</span><span class="op">,</span> <span class="va">region</span>.<span class="at">value</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="op">}</span></a></code></pre></div>
<p>âœ… åˆ·æ–°ä½ çš„è¨˜æ†¶ â”€â”€ ä¸Šå ‚èª²ä¸­çš„ HTML æª”æ¡ˆé–‹é ­æœ‰å…©å€‹è¼¸å…¥å€åŸŸï¼Œå®ƒå€‘çš„ <code>values</code> è¢«å­˜åˆ° <code>const</code> ä¸­ï¼Œä¸¦ä¸”è¢«å®šç‚º <code>required</code>ï¼Œè¡¨ç¤ºç€è¦½å™¨ç¦æ­¢ä½¿ç”¨è€…è¼¸å…¥ç©ºå€¼ã€‚</p>
<h3 id="è¨­å®šä½¿ç”¨è€…">è¨­å®šä½¿ç”¨è€…</h3>
<p>ä¾†åˆ°å‡½å¼ <code>setUpUser</code>ï¼Œé€™è£¡ä½ èƒ½æ‰¾åˆ° apiKey èˆ‡ regionName è¢«å­˜åˆ° Local Storage ä¸­ã€‚æ–°å¢å‡½å¼ï¼š</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">function</span> <span class="at">setUpUser</span>(apiKey<span class="op">,</span> regionName) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">    <span class="va">localStorage</span>.<span class="at">setItem</span>(<span class="st">&#39;apiKey&#39;</span><span class="op">,</span> apiKey)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-3" title="3">    <span class="va">localStorage</span>.<span class="at">setItem</span>(<span class="st">&#39;regionName&#39;</span><span class="op">,</span> regionName)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="va">loading</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;block&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-5" title="5">    <span class="va">errors</span>.<span class="at">textContent</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-6" title="6">    <span class="va">clearBtn</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;block&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-7" title="7">    <span class="co">//å»ºç«‹åˆå§‹åŒ–å‘¼å«</span></a>
<a class="sourceLine" id="cb5-8" title="8">    <span class="at">displayCarbonUsage</span>(apiKey<span class="op">,</span> regionName)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="op">}</span></a></code></pre></div>
<p>é€™å€‹å‡½å¼è¨­å®šç•¶ API è¢«å‘¼å«æ™‚ï¼Œé¡¯ç¤ºè®€å–è¨Šæ¯ã€‚åˆ°é€™è£¡ï¼Œä½ å³å°‡å»ºç«‹é€™å€‹æ“´å……åŠŸèƒ½å°ˆæ¡ˆæœ€é‡è¦çš„å‡½å¼ï¼</p>
<h3 id="é¡¯ç¤ºç¢³æ’æ”¾é‡">é¡¯ç¤ºç¢³æ’æ”¾é‡</h3>
<p>æœ€å¾Œï¼Œæ˜¯æ™‚å€™æŸ¥è©¢ API äº†ï¼</p>
<p>åœ¨å‰å¾€ä¸‹ä¸€æ­¥å‰ï¼Œæˆ‘å€‘å…ˆä¾†è¨è«–ä½•è¬‚ APIã€‚APIï¼Œ<a href="https://www.webopedia.com/TERM/A/API.html">Application Programming Interfaces</a>ï¼Œæ˜¯ç¶²é é–‹ç™¼è€…å·¥å…·ç®±å…§æœ€é‡è¦çš„æˆå“¡ã€‚å®ƒå€‘æä¾›ç¨‹å¼æ¨™æº–çš„äº’å‹•æ¨¡å¼èˆ‡æºé€šä»‹é¢ï¼Œèˆ‰ä¾‹ä¾†èªªï¼Œå¦‚æœä½ å»ºç«‹ä¸€å€‹éœ€è¦å­˜å–è³‡æ–™åº«çš„ç¶²é ï¼Œè³‡æ–™åº«æ–¹å¯èƒ½å°±æœ‰äººå»ºç«‹äº† API ä¾›ä½ ä½¿ç”¨ã€‚API æœ‰å„å¼å„æ¨£çš„ç¨®é¡ï¼Œæœ€æ™®éä½¿ç”¨çš„ç‚º<a href="https://www.smashingmagazine.com/2018/01/understanding-using-rest-api/">REST API</a>ã€‚</p>
<p>âœ… â€˜RESTâ€™ å…¨åç‚º â€˜Representational State Transferâ€™ï¼Œæä¾›å„å¼å„æ¨£ URL å½¢å¼ä¾†æŠ“å–è³‡æ–™ã€‚å°ç¶²è·¯é–‹ç™¼è€…çš„ API ç¨®é¡åšä¸€é»ç ”ç©¶ï¼Œä»€éº¼å½¢å¼çš„ API æœ€å¸å¼•ä½ ï¼Ÿ</p>
<p>é€™æ¢å‡½å¼ä¸­æœ‰ä¸€å€‹é‡è¦åˆ°å€¼å¾—ç´€éŒ„çš„äº‹æƒ…ã€‚ç¬¬ä¸€é»ç‚º<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">é—œéµå­— <code>async</code></a>ã€‚è®“ä½ çš„å‡½å¼éåŒæ­¥åœ°åŸ·è¡Œï¼Œåœ¨è¡Œç‚ºå®Œæˆå‰åšç­‰å¾…ï¼Œè­¬å¦‚è³‡æ–™è¢«å›å‚³ã€‚</p>
<p>é€™è£¡æœ‰ä¸€å€‹ç°¡çŸ­çš„å½±ç‰‡ä»‹ç´¹ <code>async</code>ï¼š</p>
<p><a href="https://youtube.com/watch?v=YwmlRkrxvkk" title="Async èˆ‡ Await è™•ç† promises ç‰©ä»¶"><img src="https://img.youtube.com/vi/YwmlRkrxvkk/0.jpg" alt="Async èˆ‡ Await è™•ç† promises ç‰©ä»¶" /></a></p>
<blockquote>
<p>é»æ“Šä¸Šæ–¹åœ–ç‰‡ä»¥è§€è³é—œæ–¼ async/await çš„å½±ç‰‡ã€‚</p>
</blockquote>
<p>å»ºç«‹æ–°çš„å‡½å¼ä¾†è©¢å• C02Signal çš„ APIï¼š</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="im">import</span> axios <span class="im">from</span> <span class="st">&#39;../node_modules/axios&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">async</span> <span class="kw">function</span> <span class="at">displayCarbonUsage</span>(apiKey<span class="op">,</span> region) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-4" title="4">    <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-5" title="5">        <span class="cf">await</span> axios</a>
<a class="sourceLine" id="cb6-6" title="6">            .<span class="at">get</span>(<span class="st">&#39;https://api.co2signal.com/v1/latest&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-7" title="7">                <span class="dt">params</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-8" title="8">                    <span class="dt">countryCode</span><span class="op">:</span> region<span class="op">,</span></a>
<a class="sourceLine" id="cb6-9" title="9">                <span class="op">},</span></a>
<a class="sourceLine" id="cb6-10" title="10">                <span class="dt">headers</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-11" title="11">                    <span class="st">&#39;auth-token&#39;</span><span class="op">:</span> apiKey<span class="op">,</span></a>
<a class="sourceLine" id="cb6-12" title="12">                <span class="op">},</span></a>
<a class="sourceLine" id="cb6-13" title="13">            <span class="op">}</span>)</a>
<a class="sourceLine" id="cb6-14" title="14">            .<span class="at">then</span>((response) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-15" title="15">                <span class="kw">let</span> CO2 <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(<span class="va">response</span>.<span class="va">data</span>.<span class="va">data</span>.<span class="at">carbonIntensity</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-16" title="16"></a>
<a class="sourceLine" id="cb6-17" title="17">                <span class="co">//calculateColor(CO2);</span></a>
<a class="sourceLine" id="cb6-18" title="18"></a>
<a class="sourceLine" id="cb6-19" title="19">                <span class="va">loading</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-20" title="20">                <span class="va">form</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-21" title="21">                <span class="va">myregion</span>.<span class="at">textContent</span> <span class="op">=</span> region<span class="op">;</span></a>
<a class="sourceLine" id="cb6-22" title="22">                <span class="va">usage</span>.<span class="at">textContent</span> <span class="op">=</span></a>
<a class="sourceLine" id="cb6-23" title="23">                    <span class="va">Math</span>.<span class="at">round</span>(<span class="va">response</span>.<span class="va">data</span>.<span class="va">data</span>.<span class="at">carbonIntensity</span>) <span class="op">+</span> <span class="st">&#39; grams (grams C02 emitted per kilowatt hour)&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-24" title="24">                <span class="va">fossilfuel</span>.<span class="at">textContent</span> <span class="op">=</span></a>
<a class="sourceLine" id="cb6-25" title="25">                    <span class="va">response</span>.<span class="va">data</span>.<span class="va">data</span>.<span class="va">fossilFuelPercentage</span>.<span class="at">toFixed</span>(<span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-26" title="26">                    <span class="st">&#39;% (percentage of fossil fuels used to generate electricity)&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-27" title="27">                <span class="va">results</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;block&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-28" title="28">            <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-29" title="29">    <span class="op">}</span> <span class="cf">catch</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-30" title="30">        <span class="va">console</span>.<span class="at">log</span>(error)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-31" title="31">        <span class="va">loading</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-32" title="32">        <span class="va">results</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-33" title="33">        <span class="va">errors</span>.<span class="at">textContent</span> <span class="op">=</span> <span class="st">&#39;Sorry, we have no data for the region you have requested.&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-34" title="34">    <span class="op">}</span></a>
<a class="sourceLine" id="cb6-35" title="35"><span class="op">}</span></a></code></pre></div>
<p>é€™æ˜¯ä¸€å€‹æŒºå¤§çš„å‡½å¼ï¼Œç™¼ç”Ÿäº†ä»€éº¼äº‹ï¼Ÿ</p>
<ul>
<li>éµå¾ªç¨‹å¼å¯¦è¸éç¨‹ï¼Œä½ ä½¿ç”¨é—œéµå­— <code>async</code> è®“å‡½å¼éåŒæ­¥åœ°ä½œè¡Œç‚ºã€‚å‡½å¼å…§çš„ <code>try/catch</code> å€å¡Šæœƒåœ¨ API å›å‚³è³‡æ–™æ™‚å›å‚³ promise ç‰©ä»¶ã€‚å› ç‚ºæˆ‘å€‘ç„¡æ³•æ§åˆ¶ API æœƒå¤šå¿«åœ°å›æ‡‰è¨Šæ¯(ç”šè‡³ç„¡æ³•å›æ‡‰è¨Šæ¯ï¼)ï¼Œä½ éœ€è¦è™•ç†é€™ç¨®ä¸ç¢ºå®šæ€§çš„æ™‚åºé—œä¿‚ã€‚</li>
<li>è—‰ç”±æä¾› API Key è¨ªå• co2signal API ä»¥å–å¾—ä½ çš„åœ°å€è³‡æ–™ã€‚è¦ä½¿ç”¨é€™æŠŠé‘°åŒ™ï¼Œä½ å¿…é ˆåœ¨ç¶²é æ¨™é ­ä¸­æ–°å¢èªè­‰åƒæ•¸ã€‚</li>
<li>ç•¶ API å›æ‡‰æ™‚ï¼Œä½ å°‡å„ç¨®ç‰©ä»¶å¡«å…¥å›å‚³çš„æ•¸å€¼ï¼Œä¸¦è¼¸å‡ºåˆ°ç•«é¢ä¸Šä¸­ã€‚</li>
<li>å¦‚æœç™¼ç”ŸéŒ¯èª¤ï¼Œæˆ–æ²’æœ‰çµæœç”¢ç”Ÿï¼Œè¼¸å‡ºéŒ¯èª¤è¨Šæ¯ã€‚</li>
</ul>
<p>âœ… éåŒæ­¥ç¨‹å¼è¨­è¨ˆæ˜¯ä¸€ç¨®å¯¦ç”¨çš„å·¥å…·ã€‚é–±è®€<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">æ›´å¤šä½¿ç”¨æ–¹æ³•</a>è¨­å®šéåŒæ­¥ç¨‹å¼çš„ç¨‹å¼ç¢¼ã€‚</p>
<p>æ­å–œä½ ï¼ç•¶ä½ å»ºåˆ¶ä½ çš„å°ˆæ¡ˆ(<code>npm run build</code>)ä¸¦åœ¨ç€è¦½å™¨ä¸Šåˆ·æ–°åŠŸèƒ½ï¼Œä½ æœ‰å€‹å¯ä»¥é‹ä½œçš„æ‡‰ç”¨å¥—ä»¶äº†ï¼ç¾åœ¨åªå·®åœ–ç¤ºç„¡æ³•æ­£å¸¸é¡¯ç¤ºï¼Œæˆ‘å€‘æœƒåœ¨ä¸‹ä¸€å ‚èª²ä¸­ä¿®æ­£å®ƒã€‚</p>
<hr />
<h2 id="æŒ‘æˆ°">ğŸš€ æŒ‘æˆ°</h2>
<p>æˆ‘å€‘åœ¨èª²ç¨‹ä¸­è¨è«–äº†ä¸åŒç¨®é¡çš„ APIã€‚é¸æ“‡ä¸€æ¨£ç¶²é  API ä¸¦åšæ›´æ·±åº¦çš„ç ”ç©¶ã€‚èˆ‰ä¾‹ä¾†èªªï¼Œçœ‹çœ‹ç€è¦½å™¨å…§æ”¯æ´çš„ API å¦‚ <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API">HTML Drag and Drop API</a>ã€‚ä¾ä½ çœ‹ï¼Œä»€éº¼æ±ºå®šäº† API çš„å„ªåŠ£ï¼Ÿ</p>
<h2 id="èª²å¾Œæ¸¬é©—">èª²å¾Œæ¸¬é©—</h2>
<p><a href="https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/26?loc=zh_tw">èª²å¾Œæ¸¬é©—</a></p>
<h2 id="è¤‡ç¿’èˆ‡è‡ªå­¸">è¤‡ç¿’èˆ‡è‡ªå­¸</h2>
<p>é€™å ‚èª²ä½ å­¸æœƒé—œæ–¼ LocalStorage èˆ‡ APIï¼Œå®ƒå€‘å°è³‡æ·±ç¶²é é–‹ç™¼è€…æä¾›å¾ˆå¤§çš„å¹«åŠ©ã€‚ä½ èƒ½æƒ³æƒ³é€™å…©æ¨£æ±è¥¿å¦‚ä½•å½¼æ­¤ç›¸äº’åˆä½œå‘¢ï¼Ÿæƒ³æƒ³ä½ æœƒå¦‚ä½•å»ºæ§‹ä½ çš„ç¶²é ï¼Œè®“ API å¾—ä»¥ä½¿ç”¨ä½ æ‰€å„²å­˜çš„è³‡æ–™ã€‚</p>
<h2 id="ä½œæ¥­">ä½œæ¥­</h2>
<p><a href="assignment.zh-tw.md">èªé ˜ä¸€é … API</a></p>
</body>
</html>
