<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README.es</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="plantillas-html-y-rutas-en-una-aplicaci√≥n-web">Plantillas HTML y rutas en una aplicaci√≥n web</h1>
<h2 id="pre-lecture-prueba"><a href="https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/41">Pre-lecture prueba</a></h2>
<h3 id="introducci√≥n">Introducci√≥n</h3>
<p>Desde la llegada de JavaScript a los navegadores, los sitios web se est√°n volviendo m√°s interactivos y complejos que nunca. Las tecnolog√≠as web ahora se utilizan com√∫nmente para crear aplicaciones completamente funcionales que se ejecutan directamente en un navegador que llamamos <a href="https://en.wikipedia.org/wiki/Web_application">aplicaciones web</a>. Como las aplicaciones web son muy interactivas, los usuarios no quieren esperar a que se vuelva a cargar la p√°gina completa cada vez que se realiza una acci√≥n. Es por eso que JavaScript se usa para actualizar el HTML directamente usando el DOM, para brindar una experiencia de usuario m√°s fluida.</p>
<p>En esta lecci√≥n, vamos a sentar las bases para crear una aplicaci√≥n web bancaria, utilizando plantillas HTML para crear m√∫ltiples pantallas que se pueden mostrar y actualizar sin tener que volver a cargar toda la p√°gina HTML.</p>
<h3 id="requisito-previo">Requisito previo</h3>
<p>Necesita un servidor web local para probar la aplicaci√≥n web que crearemos en esta lecci√≥n. Si no tiene uno, puede instalar <a href="https://nodejs.org">Node.js</a> y usar el comando <code>npx lite-server</code> de la carpeta de su proyecto. Crear√° un servidor web local y abrir√° su aplicaci√≥n en un navegador.</p>
<h3 id="preparaci√≥n">Preparaci√≥n</h3>
<p>En su computadora, cree una carpeta llamada <code>bank</code> con un archivo llamado <code>index.html</code> dentro. Comenzaremos desde este HTML <a href="https://en.wikipedia.org/wiki/Boilerplate_code">boilerplate</a>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb1-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">&lt;html</span><span class="ot"> lang=</span><span class="st">&quot;en&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="kw">&lt;meta</span><span class="ot"> charset=</span><span class="st">&quot;UTF-8&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="kw">&lt;meta</span><span class="ot"> name=</span><span class="st">&quot;viewport&quot;</span><span class="ot"> content=</span><span class="st">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb1-6" title="6">    <span class="kw">&lt;title&gt;</span>Bank App<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb1-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb1-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb1-9" title="9">    <span class="co">&lt;!-- Aqu√≠ es donde trabajar√°s --&gt;</span></a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<hr />
<h2 id="plantillas-html">Plantillas HTML</h2>
<p>Si desea crear varias pantallas para una p√°gina web, una soluci√≥n ser√≠a crear un archivo HTML para cada pantalla que desee mostrar. Sin embargo, esta soluci√≥n tiene algunos inconvenientes:</p>
<ul>
<li>Tienes que volver a cargar todo el HTML al cambiar de pantalla, lo que puede ser lento.</li>
<li>Es dif√≠cil compartir datos entre las diferentes pantallas.</li>
</ul>
<p>Otro enfoque es tener un solo archivo HTML y definir m√∫ltiples <a href="https://developer.mozilla.org/docs/Web/HTML/Element/template">plantillas HTML</a> usando el elemento <code>&lt;template&gt;</code>. Una plantilla es un bloque HTML reutilizable que el navegador no muestra y debe instanciarse en tiempo de ejecuci√≥n mediante JavaScript.</p>
<h3 id="tarea">Tarea:</h3>
<p>Crearemos una aplicaci√≥n bancaria con dos pantallas: la p√°gina de inicio de sesi√≥n y el panel de control. Primero, agreguemos en el cuerpo HTML un elemento de marcador de posici√≥n que usaremos para instanciar las diferentes pantallas de nuestra aplicaci√≥n:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;app&quot;</span><span class="kw">&gt;</span>Loading...<span class="kw">&lt;/div&gt;</span></a></code></pre></div>
<p>Le daremos un <code>id</code> para que sea m√°s f√°cil localizarlo con JavaScript m√°s adelante.</p>
<blockquote>
<p>Consejo: dado que el contenido de este elemento ser√° reemplazado, podemos poner un mensaje de carga o un indicador que se mostrar√° mientras se carga la aplicaci√≥n.</p>
</blockquote>
<p>A continuaci√≥n, agreguemos debajo la plantilla HTML para la p√°gina de inicio de sesi√≥n. Por ahora, solo pondremos all√≠ un t√≠tulo y una secci√≥n que contiene un bot√≥n que usaremos para realizar la navegaci√≥n.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">&lt;template</span><span class="ot"> id=</span><span class="st">&quot;login&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="kw">&lt;h1&gt;</span>Bank App<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb3-3" title="3">  <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw">&lt;button&gt;</span>Login<span class="kw">&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb3-5" title="5">  <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="kw">&lt;/template&gt;</span></a></code></pre></div>
<p>Luego agregaremos otra plantilla HTML para la p√°gina del tablero. Esta p√°gina contendr√° diferentes secciones: - Un encabezado con un t√≠tulo y un bot√≥n para cerrar sesi√≥n - El saldo actual de la cuenta bancaria - Una lista de transacciones, que se muestra en una tabla.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">&lt;template</span><span class="ot"> id=</span><span class="st">&quot;dashboard&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="kw">&lt;header&gt;</span></a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="kw">&lt;h1&gt;</span>Bank App<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="kw">&lt;button&gt;</span>Logout<span class="kw">&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="kw">&lt;/header&gt;</span></a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb4-7" title="7">    Balance: 100$</a>
<a class="sourceLine" id="cb4-8" title="8">  <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb4-9" title="9">  <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb4-10" title="10">    <span class="kw">&lt;h2&gt;</span>Transactions<span class="kw">&lt;/h2&gt;</span></a>
<a class="sourceLine" id="cb4-11" title="11">    <span class="kw">&lt;table&gt;</span></a>
<a class="sourceLine" id="cb4-12" title="12">      <span class="kw">&lt;thead&gt;</span></a>
<a class="sourceLine" id="cb4-13" title="13">        <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb4-14" title="14">          <span class="kw">&lt;th&gt;</span>Date<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb4-15" title="15">          <span class="kw">&lt;th&gt;</span>Object<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb4-16" title="16">          <span class="kw">&lt;th&gt;</span>Amount<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb4-17" title="17">        <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb4-18" title="18">      <span class="kw">&lt;/thead&gt;</span></a>
<a class="sourceLine" id="cb4-19" title="19">      <span class="kw">&lt;tbody&gt;&lt;/tbody&gt;</span></a>
<a class="sourceLine" id="cb4-20" title="20">    <span class="kw">&lt;/table&gt;</span></a>
<a class="sourceLine" id="cb4-21" title="21">  <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="kw">&lt;/template&gt;</span></a></code></pre></div>
<p>Sugerencia: al crear plantillas HTML, si desea ver c√≥mo se ver√°, puede comentar las l√≠neas <code>&lt;template&gt;</code> y <code>&lt;/template&gt;</code> encerr√°ndolas entre <code>&lt;!-- --&gt;</code>.</p>
<p>‚úÖ ¬øPor qu√© crees que usamos atributos  ªid` en las plantillas? ¬øPodr√≠amos usar algo m√°s como clases?</p>
<h2 id="visualizaci√≥n-de-plantillas-con-javascript">Visualizaci√≥n de plantillas con JavaScript</h2>
<p>Si prueba su archivo HTML actual en un navegador, ver√° que se atasca mostrando <code>Loading...</code>. Eso es porque necesitamos agregar c√≥digo JavaScript para crear instancias y mostrar las plantillas HTML.</p>
<p>La instanciaci√≥n de una plantilla se suele realizar en 3 pasos:</p>
<ol type="1">
<li>Recupere el elemento de plantilla en el DOM, por ejemplo, usando <a href="https://developer.mozilla.org/docs/Web/API/Document/getElementById"><code>document.getElementById</code></a>.</li>
<li>Clone el elemento de plantilla, usando <a href="https://developer.mozilla.org/docs/Web/API/Node/cloneNode"><code>cloneNode</code></a>.</li>
<li>Adj√∫ntelo al DOM bajo un elemento visible, por ejemplo usando <a href="https://developer.mozilla.org/docs/Web/API/Node/appendChild"> ªappendChild`</a>.</li>
</ol>
<p>‚úÖ ¬øPor qu√© necesitamos clonar la plantilla antes de adjuntarla al DOM? ¬øQu√© crees que pasar√≠a si nos salte√°ramos este paso?</p>
<h3 id="tarea-1">Tarea</h3>
<p>Cree un nuevo archivo llamado <code>app.js</code> en la carpeta de su proyecto e importe ese archivo en la secci√≥n <code>&lt;head&gt;</code> de su HTML:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;app.js&quot;</span><span class="ot"> defer</span><span class="kw">&gt;&lt;/script&gt;</span></a></code></pre></div>
<p>Ahora en <code>app.js</code>, crearemos una nueva funci√≥n <code>updateRoute</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">function</span> <span class="at">updateRoute</span>(templateId) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="kw">const</span> template <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(templateId)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="kw">const</span> view <span class="op">=</span> <span class="va">template</span>.<span class="va">content</span>.<span class="at">cloneNode</span>(<span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="kw">const</span> app <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;app&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="va">app</span>.<span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="va">app</span>.<span class="at">appendChild</span>(view)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="op">}</span></a></code></pre></div>
<p>Lo que hacemos aqu√≠ son exactamente los 3 pasos descritos anteriormente. Instalamos la plantilla con el id <code>templateId</code> y colocamos su contenido clonado dentro de nuestro marcador de posici√≥n de la aplicaci√≥n. Tenga en cuenta que necesitamos usar <code>cloneNode (true)</code> para copiar todo el sub√°rbol de la plantilla.</p>
<p>Ahora llame a esta funci√≥n con una de las plantillas y observe el resultado.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="at">updateRoute</span>(<span class="st">&#39;login&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>‚úÖ ¬øCu√°l es el prop√≥sito de este c√≥digo <code>app.innerHTML = '';</code>? ¬øQu√© pasa sin √©l?</p>
<h2 id="creando-rutas">Creando rutas</h2>
<p>Cuando hablamos de una aplicaci√≥n web, llamamos <em>Enrutamiento</em> la intenci√≥n de asignar <strong>URL</strong> a pantallas espec√≠ficas que deben mostrarse. En un sitio web con varios archivos HTML, esto se hace autom√°ticamente ya que las rutas de los archivos se reflejan en la URL. Por ejemplo, con estos archivos en la carpeta de su proyecto:</p>
<pre><code>mywebsite/index.html
mywebsite/login.html
mywebsite/admin/index.html</code></pre>
<p>Si crea un servidor web con <code>mywebsite</code> como ra√≠z, la asignaci√≥n de URL ser√°:</p>
<pre><code>https://site.com            --&gt; mywebsite/index.html
https://site.com/login.html --&gt; mywebsite/login.html
https://site.com/admin/     --&gt; mywebsite/admin/index.html</code></pre>
<p>Sin embargo, para nuestra aplicaci√≥n web estamos usando un solo archivo HTML que contiene todas las pantallas, por lo que este comportamiento predeterminado no nos ayudar√°. Tenemos que crear este mapa manualmente y actualizar la plantilla mostrada usando JavaScript.</p>
<h3 id="tarea-2">Tarea</h3>
<p>Usaremos un objeto simple para implementar un <a href="https://en.wikipedia.org/wiki/Associative_array">mapa</a> entre las rutas de URL y nuestras plantillas. Agregue este objeto en la parte superior de su archivo <code>app.js</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">const</span> routes <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="st">&#39;/login&#39;</span><span class="op">:</span> <span class="op">{</span> <span class="dt">templateId</span><span class="op">:</span> <span class="st">&#39;login&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb10-3" title="3">  <span class="st">&#39;/dashboard&#39;</span><span class="op">:</span> <span class="op">{</span> <span class="dt">templateId</span><span class="op">:</span> <span class="st">&#39;dashboard&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="op">};</span></a></code></pre></div>
<p>Ahora modifiquemos un poco la funci√≥n <code>updateRoute</code>. En lugar de pasar directamente el <code>templateId</code> como argumento, queremos recuperarlo mirando primero la URL actual y luego usar nuestro mapa para obtener el valor de ID de plantilla correspondiente. Podemos usar <a href="https://developer.mozilla.org/docs/Web/API/Location/pathname"><code>window.location.pathname</code></a> para obtener solo la secci√≥n de ruta de la URL.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">function</span> <span class="at">updateRoute</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="kw">const</span> path <span class="op">=</span> <span class="va">window</span>.<span class="va">location</span>.<span class="at">pathname</span><span class="op">;</span></a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="kw">const</span> route <span class="op">=</span> routes[path]<span class="op">;</span></a>
<a class="sourceLine" id="cb11-4" title="4"></a>
<a class="sourceLine" id="cb11-5" title="5">  <span class="kw">const</span> template <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="va">route</span>.<span class="at">templateId</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-6" title="6">  <span class="kw">const</span> view <span class="op">=</span> <span class="va">template</span>.<span class="va">content</span>.<span class="at">cloneNode</span>(<span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-7" title="7">  <span class="kw">const</span> app <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;app&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-8" title="8">  <span class="va">app</span>.<span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb11-9" title="9">  <span class="va">app</span>.<span class="at">appendChild</span>(view)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="op">}</span></a></code></pre></div>
<p>Aqu√≠ mapeamos las rutas que declaramos a la plantilla correspondiente. Puede probar que funciona correctamente cambiando la URL manualmente en su navegador.</p>
<p>‚úÖ ¬øQu√© sucede si ingresa una ruta desconocida en la URL? ¬øC√≥mo podr√≠amos solucionar esto?</p>
<h2 id="a√±adiendo-navegaci√≥n">A√±adiendo navegaci√≥n</h2>
<p>El siguiente paso para nuestra aplicaci√≥n es agregar la posibilidad de navegar entre p√°ginas sin tener que cambiar la URL manualmente. Esto implica dos cosas: 1. Actualizaci√≥n de la URL actual 2. Actualizaci√≥n de la plantilla mostrada en funci√≥n de la nueva URL</p>
<p>Ya nos ocupamos de la segunda parte con la funci√≥n <code>updateRoute</code>, as√≠ que tenemos que averiguar c√≥mo actualizar la URL actual.</p>
<p>Si bien el elemento de anclaje HTML <a href="https://developer.mozilla.org/docs/Web/HTML/Element/a"><code>&lt;a&gt;</code></a> se puede utilizar para crear hiperv√≠nculos a diferentes URL, podemos ‚Äô No use eso aqu√≠, ya que har√° que el navegador vuelva a cargar el HTML.</p>
<p>En su lugar, tendremos que usar JavaScript y m√°s espec√≠ficamente el <a href="https://developer.mozilla.org/docs/Web/API/History/pushState"><code>history.pushState</code></a> que permite actualizar la URL y cree una nueva entrada en el historial de navegaci√≥n, sin volver a cargar el HTML.</p>
<h3 id="tarea-3">Tarea</h3>
<p>Creemos una nueva funci√≥n que podamos usar para navegar en nuestra aplicaci√≥n:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">function</span> <span class="at">navigate</span>(path) <span class="op">{</span></a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="va">window</span>.<span class="va">history</span>.<span class="at">pushState</span>(<span class="op">{},</span> path<span class="op">,</span> <span class="va">window</span>.<span class="va">location</span>.<span class="at">origin</span> <span class="op">+</span> path)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-3" title="3">  <span class="at">updateRoute</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="op">}</span></a></code></pre></div>
<p>Este m√©todo primero actualiza la URL actual seg√∫n la ruta proporcionada y luego actualiza la plantilla. La propiedad <code>window.location.origin</code> devuelve la ra√≠z de la URL, lo que nos permite reconstruir una URL completa a partir de una ruta determinada.</p>
<p>Ahora que tenemos esta funci√≥n, podemos solucionar el problema que tenemos si una ruta no coincide con ninguna ruta definida. Modificaremos la funci√≥n <code>updateRoute</code> agregando un respaldo a una de las rutas existentes si no podemos encontrar una coincidencia.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">function</span> <span class="at">updateRoute</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="kw">const</span> path <span class="op">=</span> <span class="va">window</span>.<span class="va">location</span>.<span class="at">pathname</span><span class="op">;</span></a>
<a class="sourceLine" id="cb13-3" title="3">  <span class="kw">const</span> route <span class="op">=</span> routes[path]<span class="op">;</span></a>
<a class="sourceLine" id="cb13-4" title="4"></a>
<a class="sourceLine" id="cb13-5" title="5">  <span class="cf">if</span> (<span class="op">!</span>route) <span class="op">{</span></a>
<a class="sourceLine" id="cb13-6" title="6">    <span class="cf">return</span> <span class="at">navigate</span>(<span class="st">&#39;/login&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb13-8" title="8"></a>
<a class="sourceLine" id="cb13-9" title="9">  ...</a></code></pre></div>
<p>Si no se puede encontrar una ruta, ahora lo redireccionaremos a la p√°gina de <code>login</code>.</p>
<p>Completemos el sistema de navegaci√≥n agregando enlaces a nuestros botones <em>login</em> y <em>logout</em> en el HTML.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;navigate(&#39;/dashboard&#39;)&quot;</span><span class="kw">&gt;</span>Login<span class="kw">&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb14-2" title="2">...</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;navigate(&#39;/login&#39;)&quot;</span><span class="kw">&gt;</span>Logout<span class="kw">&lt;/button&gt;</span></a></code></pre></div>
<p>Usando el atributo <a href="https://developer.mozilla.org/docs/Web/API/GlobalEventHandlers/onclick"><code>onclick</code></a> enlaza el evento <code>click</code> al c√≥digo JavaScript, aqu√≠ la llamada al<code>navigate()</code>funci√≥n.</p>
<p>Intente hacer clic en estos botones, ahora deber√≠a poder navegar entre las diferentes pantallas de su aplicaci√≥n.</p>
<p>‚úÖ El m√©todo <code>history.pushState</code> es parte del est√°ndar HTML5 y est√° implementado en <a href="https://caniuse.com/?search=pushState">todos los navegadores modernos</a>. Si est√° creando una aplicaci√≥n web para navegadores m√°s antiguos, hay un truco que puede usar en lugar de esta API: usar un <a href="https://en.wikipedia.org/wiki/URI_fragment">hash (<code>#</code>)</a> antes la ruta puede implementar un enrutamiento que funcione con la navegaci√≥n de anclaje regular y no recargue la p√°gina, ya que su prop√≥sito era crear enlaces internos dentro de una p√°gina.</p>
<h2 id="manejo-de-los-botones-de-avance-y-retroceso-del-navegador">Manejo de los botones de avance y retroceso del navegador</h2>
<p>El uso de <code>history.pushState</code> crea nuevas entradas en el historial de navegaci√≥n del navegador. Puede verificar que manteniendo presionado el <em>bot√≥n de retroceso</em> de su navegador, deber√≠a mostrar algo como esto:</p>
<figure>
<img src="./history.png" alt="Captura de pantalla del historial de navegaci√≥n" /><figcaption>Captura de pantalla del historial de navegaci√≥n</figcaption>
</figure>
<p>Si intenta hacer clic en el bot√≥n Atr√°s varias veces, ver√° que la URL actual cambia y el historial se actualiza, pero se sigue mostrando la misma plantilla.</p>
<p>Eso es porque no sabemos que necesitamos llamar a <code>updateRoute()</code> cada vez que cambia el historial. Si echas un vistazo a la <a href="https://developer.mozilla.org/docs/Web/API/History/pushState"><code>history.pushState</code> documentation</a>, puedes ver que si el estado cambia - lo que significa que nos mudamos a una URL diferente - se activa el evento <a href="https://developer.mozilla.org/docs/Web/API/Window/popstate_event"><code>popstate</code></a>. Lo usaremos para solucionar ese problema.</p>
<h3 id="tarea-4">Tarea</h3>
<p>Para asegurarnos de que la plantilla mostrada se actualice cuando cambie el historial del navegador, adjuntaremos una nueva funci√≥n que llama a <code>updateRoute()</code>. Lo haremos en la parte inferior de nuestro archivo <code>app.js</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="va">window</span>.<span class="at">onpopstate</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="at">updateRoute</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="at">updateRoute</span>()<span class="op">;</span></a></code></pre></div>
<blockquote>
<p>Nota: utilizamos una <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Functions/Arrow_functions">funci√≥n de flecha</a> aqu√≠ para declarar nuestro controlador de eventos <code>popstate</code> por concisi√≥n, pero un la funci√≥n regular funcionar√≠a igual.</p>
</blockquote>
<p>Ahora intente utilizar los botones de avance y retroceso de sus navegadores y compruebe que esta vez lo que se muestra est√° actualizado correctamente.</p>
<hr />
<h2 id="desaf√≠o">üöÄ Desaf√≠o</h2>
<p>Agregue una nueva plantilla y ruta para una tercera p√°gina que muestre los cr√©ditos de esta aplicaci√≥n.</p>
<h2 id="post-lecture-prueba"><a href="https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/42">Post-lecture prueba</a></h2>
<h2 id="revisi√≥n-y-autoestudio">Revisi√≥n y autoestudio</h2>
<p><strong>Tarea</strong>: <a href="assignment.es.md">Mejorar el enrutamiento</a></p>
</body>
</html>
