<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="vscode-json-language-server">VSCode JSON Language Server</h1>
<p><a href="https://npmjs.org/package/vscode-json-languageserver"><img src="https://img.shields.io/npm/v/vscode-json-languageserver.svg" alt="NPM Version" /></a> <a href="https://npmjs.org/package/vscode-json-languageserver"><img src="https://img.shields.io/npm/dm/vscode-json-languageserver.svg" alt="NPM Downloads" /></a> <a href="https://npmjs.org/package/vscode-json-languageserver"><img src="https://img.shields.io/npm/l/vscode-json-languageserver.svg" alt="NPM Version" /></a></p>
<p>The JSON Language server provides language-specific smarts for editing, validating and understanding JSON documents. It runs as a separate executable and implements the <a href="https://microsoft.github.io/language-server-protocol/overview">language server protocol</a> to be connected by any code editor or IDE.</p>
<h2 id="capabilities">Capabilities</h2>
<h3 id="server-capabilities">Server capabilities</h3>
<p>The JSON language server supports requests on documents of language id <code>json</code> and <code>jsonc</code>. - <code>json</code> documents are parsed and validated following the <a href="https://tools.ietf.org/html/rfc7159">JSON specification</a>. - <code>jsonc</code> documents additionally accept single line (<code>//</code>) and multi-line comments (<code>/* ... */</code>). JSONC is a VSCode specific file format, intended for VSCode configuration files, without any aspirations to define a new common file format.</p>
<p>The server implements the following capabilities of the language server protocol:</p>
<ul>
<li><a href="https://microsoft.github.io/language-server-protocol/specification#textDocument_completion">Code completion</a> for JSON properties and values based on the document’s <a href="http://json-schema.org/">JSON schema</a> or based on existing properties and values used at other places in the document. JSON schemas are configured through the server configuration options.</li>
<li><a href="https://microsoft.github.io/language-server-protocol/specification#textDocument_hover">Hover</a> for values based on descriptions in the document’s <a href="http://json-schema.org/">JSON schema</a>.</li>
<li><a href="https://microsoft.github.io/language-server-protocol/specification#textDocument_documentSymbol">Document Symbols</a> for quick navigation to properties in the document.</li>
<li><a href="https://microsoft.github.io/language-server-protocol/specification#textDocument_documentColor">Document Colors</a> for showing color decorators on values representing colors and <a href="https://microsoft.github.io/language-server-protocol/specification#textDocument_colorPresentation">Color Presentation</a> for color presentation information to support color pickers. The location of colors is defined by the document’s <a href="http://json-schema.org/">JSON schema</a>. All values marked with <code>"format": "color-hex"</code> (VSCode specific, non-standard JSON Schema extension) are considered color values. The supported color formats are <code>#rgb[a]</code> and <code>#rrggbb[aa]</code>.</li>
<li><a href="https://microsoft.github.io/language-server-protocol/specification#textDocument_rangeFormatting">Code Formatting</a> supporting ranges and formatting the whole document.</li>
<li><a href="https://microsoft.github.io/language-server-protocol/specification#textDocument_foldingRange">Folding Ranges</a> for all folding ranges in the document.</li>
<li>Semantic Selection for semantic selection for one or multiple cursor positions.</li>
<li><a href="https://microsoft.github.io/language-server-protocol/specification#textDocument_definition">Goto Definition</a> for $ref references in JSON schemas</li>
<li><a href="https://microsoft.github.io/language-server-protocol/specification#textDocument_publishDiagnostics">Diagnostics (Validation)</a> are pushed for all open documents
<ul>
<li>syntax errors</li>
<li>structural validation based on the document’s <a href="http://json-schema.org/">JSON schema</a>.</li>
</ul></li>
</ul>
<p>In order to load JSON schemas, the JSON server uses NodeJS <code>http</code> and <code>fs</code> modules. For all other features, the JSON server only relies on the documents and settings provided by the client through the LSP.</p>
<h3 id="client-requirements">Client requirements:</h3>
<p>The JSON language server expects the client to only send requests and notifications for documents of language id <code>json</code> and <code>jsonc</code>.</p>
<p>The JSON language server has the following dependencies on the client’s capabilities:</p>
<ul>
<li>Code completion requires that the client capability has <em>snippetSupport</em>. If not supported by the client, the server will not offer the completion capability.</li>
<li>Formatting support requires the client to support <em>dynamicRegistration</em> for <em>rangeFormatting</em>. If not supported by the client, the server will not offer the format capability.</li>
</ul>
<h2 id="configuration">Configuration</h2>
<h3 id="initialization-options">Initialization options</h3>
<p>The client can send the following initialization options to the server:</p>
<ul>
<li><code>provideFormatter: boolean | undefined</code>. If defined, the value defines whether the server provides the <code>documentRangeFormattingProvider</code> capability on initialization. If undefined, the setting <code>json.format.enable</code> is used to determine whether formatting is provided. The formatter will then be registered through dynamic registration. If the client does not support dynamic registration, no formatter will be available.</li>
<li><code>handledSchemaProtocols</code>: The URI schemas handles by the server. See section <code>Schema configuration</code> below.</li>
<li><code>customCapabilities</code>: Additional non-LSP client capabilities:
<ul>
<li><code>rangeFormatting: { editLimit: x } }</code>: For performance reasons, limit the number of edits returned by the range formatter to <code>x</code>.</li>
</ul></li>
</ul>
<h3 id="settings">Settings</h3>
<p>Clients may send a <code>workspace/didChangeConfiguration</code> notification to notify the server of settings changes. The server supports the following settings:</p>
<ul>
<li>http
<ul>
<li><code>proxy</code>: The URL of the proxy server to use when fetching schema. When undefined or empty, no proxy is used.</li>
<li><code>proxyStrictSSL</code>: Whether the proxy server certificate should be verified against the list of supplied CAs.</li>
</ul></li>
<li>json
<ul>
<li><code>format</code>
<ul>
<li><code>enable</code>: Whether the server should register the formatting support. This option is only applicable if the client supports <em>dynamicRegistration</em> for <em>rangeFormatting</em> and <code>initializationOptions.provideFormatter</code> is not defined.</li>
</ul></li>
<li><code>schemas</code>: Configures association of file names to schema URL or schemas and/or associations of schema URL to schema content.
<ul>
<li><code>fileMatch</code>: an array of file names or paths (separated by <code>/</code>). <code>*</code> can be used as a wildcard. Exclusion patterns can also be defined and start with ‘!’. A file matches when there is at least one matching pattern and the last matching pattern is not an exclusion pattern.</li>
<li><code>url</code>: The URL of the schema, optional when also a schema is provided.</li>
<li><code>schema</code>: The schema content.</li>
</ul></li>
<li><code>resultLimit</code>: The max number folding ranges and outline symbols to be computed (for performance reasons)</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb1-1" title="1">    <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">        <span class="dt">&quot;http&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-3" title="3">            <span class="dt">&quot;proxy&quot;</span><span class="fu">:</span> <span class="st">&quot;&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-4" title="4">            <span class="dt">&quot;proxyStrictSSL&quot;</span><span class="fu">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb1-5" title="5">        <span class="fu">},</span></a>
<a class="sourceLine" id="cb1-6" title="6">        <span class="dt">&quot;json&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-7" title="7">            <span class="dt">&quot;format&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-8" title="8">                <span class="dt">&quot;enable&quot;</span><span class="fu">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb1-9" title="9">            <span class="fu">},</span></a>
<a class="sourceLine" id="cb1-10" title="10">            <span class="dt">&quot;schemas&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb1-11" title="11">                <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-12" title="12">                    <span class="dt">&quot;fileMatch&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb1-13" title="13">                        <span class="st">&quot;foo.json&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb1-14" title="14">                        <span class="st">&quot;*.superfoo.json&quot;</span></a>
<a class="sourceLine" id="cb1-15" title="15">                    <span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-16" title="16">                    <span class="dt">&quot;url&quot;</span><span class="fu">:</span> <span class="st">&quot;http://json.schemastore.org/foo&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-17" title="17">                    <span class="dt">&quot;schema&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-18" title="18">                        <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;array&quot;</span></a>
<a class="sourceLine" id="cb1-19" title="19">                    <span class="fu">}</span></a>
<a class="sourceLine" id="cb1-20" title="20">                <span class="fu">}</span></a>
<a class="sourceLine" id="cb1-21" title="21">            <span class="ot">]</span></a>
<a class="sourceLine" id="cb1-22" title="22">        <span class="fu">}</span></a>
<a class="sourceLine" id="cb1-23" title="23">    <span class="fu">}</span></a></code></pre></div>
<h3 id="schema-configuration-and-custom-schema-content-delivery">Schema configuration and custom schema content delivery</h3>
<p><a href="http://json-schema.org/">JSON schemas</a> are essential for code assist, hovers, color decorators to work and are required for structural validation.</p>
<p>To find the schema for a given JSON document, the server uses the following mechanisms: - JSON documents can define the schema URL using a <code>$schema</code> property - The settings define a schema association based on the documents URL. Settings can either associate a schema URL to a file or path pattern, and they can directly provide a schema. - Additionally, schema associations can also be provided by a custom ‘schemaAssociations’ configuration call.</p>
<p>Schemas are identified by URLs. To load the content of a schema, the JSON language server either tries to load from that URI or path itself or delegates to the client.</p>
<p>The <code>initializationOptions.handledSchemaProtocols</code> initialization option defines which URLs are handled by the server. Requests for all other URIs are sent to the client.</p>
<p><code>handledSchemaProtocols</code> is part of the initialization options and can’t be changed while the server is running.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode ts"><code class="sourceCode typescript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">let</span> clientOptions<span class="op">:</span> LanguageClientOptions <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">        initializationOptions<span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">            handledSchemaProtocols<span class="op">:</span> <span class="op">[</span><span class="st">&#39;file&#39;</span><span class="op">]</span> <span class="co">// language server should only try to load file URLs</span></a>
<a class="sourceLine" id="cb2-4" title="4">        <span class="op">}</span></a>
<a class="sourceLine" id="cb2-5" title="5">        <span class="op">...</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="op">}</span></a></code></pre></div>
<p>If <code>handledSchemaProtocols</code> is not set, the JSON language server will load the following URLs itself:</p>
<ul>
<li><code>http</code>, <code>https</code>: Loaded using NodeJS’s HTTP support. Proxies can be configured through the settings.</li>
<li><code>file</code>: Loaded using NodeJS’s <code>fs</code> support.</li>
</ul>
<h4 id="schema-content-request">Schema content request</h4>
<p>Requests for schemas with URLs not handled by the server are forwarded to the client through an LSP request. This request is a JSON language server-specific, non-standardized, extension to the LSP.</p>
<p>Request: - method: ‘vscode/content’ - params: <code>string</code> - The schema URL to request. - response: <code>string</code> - The content of the schema with the given URL</p>
<h4 id="schema-content-change-notification">Schema content change notification</h4>
<p>When the client is aware that a schema content has changed, it will notify the server through a notification. This notification is a JSON language server-specific, non-standardized, extension to the LSP. The server will, as a response, clear the schema content from the cache and reload the schema content when required again.</p>
<h4 id="schema-associations-notification">Schema associations notification</h4>
<p>In addition to the settings, schemas associations can also be provided through a notification from the client to the server. This notification is a JSON language server-specific, non-standardized, extension to the LSP.</p>
<p>Notification: - method: ‘json/schemaAssociations’ - params: <code>ISchemaAssociations</code> or <code>ISchemaAssociation[]</code> defined as follows</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode ts"><code class="sourceCode typescript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">interface</span> ISchemaAssociations <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="co">/**</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">   * An object where:</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">   *  - keys are file names or file paths (using `/` as path separator). `*` can be used as a wildcard.</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">   *  - values are an arrays of schema URIs</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">   */</span></a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="op">[</span>pattern<span class="op">:</span> <span class="dt">string</span><span class="op">]:</span> <span class="dt">string</span><span class="op">[];</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="kw">interface</span> ISchemaAssociation <span class="op">{</span></a>
<a class="sourceLine" id="cb3-11" title="11">  <span class="co">/**</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">   * The URI of the schema, which is also the identifier of the schema.</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">   */</span></a>
<a class="sourceLine" id="cb3-14" title="14">  uri<span class="op">:</span> <span class="dt">string</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-15" title="15"></a>
<a class="sourceLine" id="cb3-16" title="16">  <span class="co">/**</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">   * A list of file path patterns that are associated to the schema. The &#39;*&#39; wildcard can be used. Exclusion patterns starting with &#39;!&#39;.</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">   * For example &#39;*.schema.json&#39;, &#39;package.json&#39;, &#39;!foo*.schema.json&#39;.</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">   * A match succeeds when there is at least one pattern matching and last matching pattern does not start with &#39;!&#39;.</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">   */</span></a>
<a class="sourceLine" id="cb3-21" title="21">  fileMatch<span class="op">:</span> <span class="dt">string</span><span class="op">[];</span></a>
<a class="sourceLine" id="cb3-22" title="22">  <span class="co">/*</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">   * The schema for the given URI.</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">   * If no schema is provided, the schema will be fetched with the schema request service (if available).</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">   */</span></a>
<a class="sourceLine" id="cb3-26" title="26">  schema<span class="op">?:</span> JSONSchema<span class="op">;</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="op">}</span></a></code></pre></div>
<p><code>ISchemaAssociations</code> - keys: a file names or file path (separated by <code>/</code>). <code>*</code> can be used as a wildcard. - values: An array of schema URLs</p>
<p>Notification: - method: ‘json/schemaContent’ - params: <code>string</code> the URL of the schema that has changed.</p>
<h3 id="item-limit">Item Limit</h3>
<p>If the setting <code>resultLimit</code> is set, the JSON language server will limit the number of folding ranges and document symbols computed. When the limit is reached, a notification <code>json/resultLimitReached</code> is sent that can be shown that can be shown to the user.</p>
<p>Notification: - method: ‘json/resultLimitReached’ - params: a human readable string to show to the user.</p>
<h2 id="try">Try</h2>
<p>The JSON language server is shipped with <a href="https://code.visualstudio.com/">Visual Studio Code</a> as part of the built-in VSCode extension <code>json-language-features</code>. The server is started when the first JSON file is opened. The <a href="https://code.visualstudio.com/docs/languages/json">VSCode JSON documentation</a> for detailed information on the user experience and has more information on how to configure the language support.</p>
<h2 id="integrate">Integrate</h2>
<p>If you plan to integrate the JSON language server into an editor and IDE, check out <a href="https://microsoft.github.io/language-server-protocol/implementors/tools/">this page</a> if there’s already an LSP client integration available.</p>
<p>You can also launch the language server as a command and connect to it. For that, install the <code>vscode-json-languageserver</code> npm module:</p>
<p><code>npm install -g vscode-json-languageserver</code></p>
<p>Start the language server with the <code>vscode-json-languageserver</code> command. Use a command line argument to specify the preferred communication channel:</p>
<pre><code>vscode-json-languageserver --node-ipc
vscode-json-languageserver --stdio
vscode-json-languageserver --socket=&lt;port&gt;</code></pre>
<p>To connect to the server from NodeJS, see Remy Suen’s great write-up on <a href="https://github.com/rcjsuen/dockerfile-language-server-nodejs#communicating-with-the-server">how to communicate with the server</a> through the available communication channels.</p>
<h2 id="participate">Participate</h2>
<p>The source code of the JSON language server can be found in the <a href="https://github.com/microsoft/vscode">VSCode repository</a> at <a href="https://github.com/microsoft/vscode/tree/master/extensions/json-language-features/server">extensions/json-language-features/server</a>.</p>
<p>File issues and pull requests in the <a href="https://github.com/microsoft/vscode/issues">VSCode GitHub Issues</a>. See the document <a href="https://github.com/microsoft/vscode/wiki/How-to-Contribute">How to Contribute</a> on how to build and run from source.</p>
<p>Most of the functionality of the server is located in libraries: - <a href="https://github.com/microsoft/node-jsonc-parser">jsonc-parser</a> contains the JSON parser and scanner. - <a href="https://github.com/microsoft/vscode-json-languageservice">vscode-json-languageservice</a> contains the implementation of all features as a re-usable library. - <a href="https://github.com/microsoft/vscode-languageserver-node">vscode-languageserver-node</a> contains the implementation of language server for NodeJS.</p>
<p>Help on any of these projects is very welcome.</p>
<h2 id="code-of-conduct">Code of Conduct</h2>
<p>This project has adopted the <a href="https://opensource.microsoft.com/codeofconduct/">Microsoft Open Source Code of Conduct</a>. For more information see the <a href="https://opensource.microsoft.com/codeofconduct/faq/">Code of Conduct FAQ</a> or contact <a href="mailto:opencode@microsoft.com">opencode@microsoft.com</a> with any additional questions or comments.</p>
<h2 id="license">License</h2>
<p>Copyright (c) Microsoft Corporation. All rights reserved.</p>
<p>Licensed under the <a href="https://github.com/microsoft/vscode/blob/master/LICENSE.txt">MIT</a> License.</p>
</body>
</html>
