<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README.es</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="cree-un-formulario-de-inicio-de-sesi√≥n-y-registro">Cree un formulario de inicio de sesi√≥n y registro</h1>
<h2 id="prueba-previa-a-la-conferencia"><a href="https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/43">Prueba previa a la conferencia</a></h2>
<h3 id="introducci√≥n">Introducci√≥n</h3>
<p>En casi todas las aplicaciones web modernas, puede crear una cuenta para tener su propio espacio privado. Como varios usuarios pueden acceder a una aplicaci√≥n web al mismo tiempo, necesita un mecanismo para almacenar los datos personales de cada usuario por separado y seleccionar qu√© informaci√≥n mostrar. No cubriremos c√≥mo administrar <a href="https://en.wikipedia.org/wiki/Authentication">la identidad del usuario de forma segura</a> ya que es un tema extenso en s√≠ mismo, pero nos aseguraremos de que cada usuario pueda crear uno. O m√°s cuenta bancaria en nuestra aplicaci√≥n.</p>
<p>En esta parte usaremos formularios HTML para agregar inicio de sesi√≥n y registro a nuestra aplicaci√≥n web. Veremos c√≥mo enviar los datos a una API de servidor de forma program√°tica y, en √∫ltima instancia, c√≥mo definir reglas de validaci√≥n b√°sicas para las entradas del usuario.</p>
<h3 id="requisito-previo">Requisito previo</h3>
<p>Debe haber completado las <a href="../1-template-route/README.md">plantillas HTML y enrutamiento</a> de la aplicaci√≥n web para esta lecci√≥n. Tambi√©n necesita instalar <a href="https://nodejs.org">Node.js</a> y <a href="../api/README.md">ejecutar la API del servidor</a> localmente para poder enviar datos para crear cuentas.</p>
<p>Puede probar que el servidor est√° funcionando correctamente ejecutando este comando en una terminal:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">curl</span> http://localhost:5000/api</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># -&gt; should return &quot;Bank API v1.0.0&quot; as a result</span></a></code></pre></div>
<hr />
<h2 id="forma-y-controles">Forma y controles</h2>
<p>El elemento <code>&lt;form&gt;</code> encapsula una secci√≥n de un documento HTML donde el usuario puede ingresar y enviar datos con controles interactivos. Hay todo tipo de controles de interfaz de usuario (UI) que se pueden usar dentro de un formulario, siendo el m√°s com√∫n los elementos <code>&lt;input&gt;</code> y <code>&lt;button&gt;</code>.</p>
<p>Hay muchos <a href="https://developer.mozilla.org/docs/Web/HTML/Element/input">types diferentes</a> de <code>&lt;input&gt;</code>, por ejemplo, para crear un campo donde el usuario puede ingresar su nombre de usuario que puede usar:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;username&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p>El atributo <code>name</code> se usa para identificar el control y se usar√° como el nombre de la propiedad cuando se env√≠en los datos del formulario.</p>
<blockquote>
<p>Eche un vistazo a la lista completa de <a href="https://developer.mozilla.org/docs/Web/HTML/Element/input"><code>&lt;input&gt;</code> tipos</a> y <a href="https://developer.mozilla.org/docs/Learn/Forms/Other_form_controls">otros controles de formulario</a> para tener una idea de todos los elementos nativos de la interfaz de usuario que puede utilizar al crear su interfaz de usuario.</p>
</blockquote>
<p>‚úÖ Tenga en cuenta que <code>&lt;input&gt;</code> es un <a href="https://developer.mozilla.org/docs/Glossary/Empty_element">elemento vac√≠o</a> en el que <em>no</em> debe agregar una etiqueta de cierre coincidente. Sin embargo, puede usar la notaci√≥n de cierre autom√°tico <code>&lt;input/&gt;</code>, pero no es necesaria.</p>
<p>El elemento <code>&lt;button&gt;</code> dentro de un formulario es un poco especial. Si no especifica su atributo <code>type</code>, autom√°ticamente enviar√° los datos del formulario al servidor cuando se presione. Estos son los posibles valores de tipo:</p>
<ul>
<li><code>enviar</code>: el valor predeterminado dentro de un<code>&lt;formulario&gt;</code>, el bot√≥n activa la acci√≥n de env√≠o del formulario.</li>
<li><code>reset</code>: El bot√≥n restablece todos los controles de formulario a sus valores iniciales.</li>
<li><code>button</code>: No asigna un comportamiento predeterminado cuando se presiona el bot√≥n. A continuaci√≥n, puede asignarle acciones personalizadas mediante JavaScript.</li>
</ul>
<h3 id="tarea">Tarea:</h3>
<p>Comencemos agregando un formulario a la plantilla de inicio de sesi√≥n. Necesitaremos un campo <em>nombre de usuario</em> y un bot√≥n <em>Iniciar sesi√≥n</em>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">&lt;template</span><span class="ot"> id=</span><span class="st">&quot;login&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="kw">&lt;h1&gt;</span>Bank App<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb3-3" title="3">  <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw">&lt;h2&gt;</span>Login<span class="kw">&lt;/h2&gt;</span></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="kw">&lt;form</span><span class="ot"> id=</span><span class="st">&quot;loginForm&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-6" title="6">      <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;user&quot;</span><span class="kw">&gt;</span>Username<span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb3-7" title="7">      <span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;user&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-8" title="8">      <span class="kw">&lt;button&gt;</span>Login<span class="kw">&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="kw">&lt;/form&gt;</span></a>
<a class="sourceLine" id="cb3-10" title="10">  <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="kw">&lt;/template&gt;</span></a></code></pre></div>
<p>Si observa m√°s de cerca, puede notar que tambi√©n agregamos un elemento <code>&lt;label&gt;</code> aqu√≠. Las <code>&lt;label&gt;</code> se utilizan para agregar un t√≠tulo para los controles de la IU, como nuestro campo de nombre de usuario. Las etiquetas son importantes para la legibilidad de sus formularios, pero tambi√©n tienen beneficios adicionales:</p>
<ul>
<li>Al asociar una etiqueta a un control de formulario, ayuda a los usuarios que utilizan tecnolog√≠as de asistencia (como un lector de pantalla) a comprender qu√© datos se espera que proporcionen.</li>
<li>Puede hacer clic en la etiqueta para centrarse directamente en la entrada asociada, lo que facilita el acceso a los dispositivos con pantalla t√°ctil.</li>
</ul>
<blockquote>
<p><a href="https://developer.mozilla.org/docs/Learn/Accessibility/What_is_accessibility">Accesibilidad</a> en la web es un tema muy importante que a menudo se pasa por alto. Gracias a los <a href="https://developer.mozilla.org/docs/Learn/Accessibility/HTML">elementos sem√°nticos HTML5</a> no es dif√≠cil crear contenido accesible si los usas correctamente. Puede <a href="https://developer.mozilla.org/docs/Web/Accessibility">leer m√°s sobre accesibilidad</a> para evitar errores comunes y convertirse en un desarrollador responsable.</p>
</blockquote>
<p>Ahora agregaremos un segundo formulario para el registro, justo debajo del anterior:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">&lt;hr/&gt;</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">&lt;h2&gt;</span>Register<span class="kw">&lt;/h2&gt;</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">&lt;form</span><span class="ot"> id=</span><span class="st">&quot;registerForm&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;user&quot;</span><span class="kw">&gt;</span>Username<span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;user&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;currency&quot;</span><span class="kw">&gt;</span>Currency<span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;currency&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;$&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-8" title="8">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;description&quot;</span><span class="kw">&gt;</span>Description<span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb4-9" title="9">  <span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;description&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-10" title="10">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;balance&quot;</span><span class="kw">&gt;</span>Current balance<span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb4-11" title="11">  <span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;balance&quot;</span><span class="ot"> type=</span><span class="st">&quot;number&quot;</span><span class="ot"> value=</span><span class="st">&quot;0&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-12" title="12">  <span class="kw">&lt;button&gt;</span>Register<span class="kw">&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="kw">&lt;/form&gt;</span></a></code></pre></div>
<p>Usando el atributo <code>value</code> podemos definir un valor predeterminado para una entrada dada. Observe tambi√©n que la entrada para <code>balance</code> tiene el tipo <code>number</code>. ¬øSe ve diferente a las otras entradas? Intenta interactuar con √©l.</p>
<p>‚úÖ ¬øPuede navegar e interactuar con los formularios usando solo un teclado? ¬øC√≥mo lo har√≠as t√∫?</p>
<h2 id="env√≠o-de-datos-al-servidor">Env√≠o de datos al servidor</h2>
<p>Ahora que tenemos una interfaz de usuario funcional, el siguiente paso es enviar los datos a nuestro servidor. Hagamos una prueba r√°pida con nuestro c√≥digo actual: ¬øqu√© sucede si hace clic en el bot√≥n <em>Iniciar sesi√≥n</em> o <em>Registrarse</em>?</p>
<p>¬øNot√≥ el cambio en la secci√≥n de URL de su navegador?</p>
<p>! <a href="./images/click-register.png">Captura de pantalla del cambio de URL del navegador despu√©s de hacer clic en el bot√≥n Registrar</a></p>
<p>La acci√≥n predeterminada para un <code>&lt;form&gt;</code> es enviar el formulario a la URL del servidor actual utilizando el <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3">m√©todo GET</a>, agregando los datos del formulario directamente a la URL. Sin embargo, este m√©todo tiene algunas deficiencias:</p>
<ul>
<li>Los datos enviados son de tama√±o muy limitado (unos 2000 caracteres)</li>
<li>Los datos son directamente visibles en la URL (no es ideal para contrase√±as)</li>
<li>No funciona con cargas de archivos.</li>
</ul>
<p>Es por eso que puede cambiarlo para usar el <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.5">m√©todo POST</a> que env√≠a los datos del formulario al servidor en el cuerpo de la solicitud HTTP, sin ninguna de las limitaciones anteriores.</p>
<blockquote>
<p>Si bien POST es el m√©todo m√°s utilizado para enviar datos, <a href="https://www.w3.org/2001/tag/doc/whenToUseGet.html">en algunos escenarios espec√≠ficos</a> es preferible utilizar el m√©todo GET, al implementar un campo de b√∫squeda, por ejemplo.</p>
</blockquote>
<h3 id="tarea-1">Tarea</h3>
<p>Agregue las propiedades <code>action</code> y <code>method</code> al formulario de registro:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">&lt;form</span><span class="ot"> id=</span><span class="st">&quot;registerForm&quot;</span><span class="ot"> action=</span><span class="st">&quot;//localhost:5000/api/accounts&quot;</span><span class="ot"> method=</span><span class="st">&quot;POST&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p>Ahora intente registrar una nueva cuenta con su nombre. Despu√©s de hacer clic en el bot√≥n * Registrarse *, deber√≠a ver algo como esto:</p>
<p><img src="./images/form-post.png" /></p>
<p>Si todo va bien, el servidor debe responder a su solicitud con una respuesta <a href="https://www.json.org/json-en.html">JSON</a> que contenga los datos de la cuenta que se cre√≥.</p>
<p>‚úÖ Intente registrarse nuevamente con el mismo nombre. ¬øLo que pasa?</p>
<h2 id="env√≠o-de-datos-sin-recargar-la-p√°gina">Env√≠o de datos sin recargar la p√°gina</h2>
<p>Como probablemente haya notado, hay un peque√±o problema con el enfoque que acabamos de usar: al enviar el formulario, salimos de nuestra aplicaci√≥n y el navegador redirige a la URL del servidor. Estamos tratando de evitar todas las recargas de p√°ginas con nuestra aplicaci√≥n web, ya que estamos creando una <a href="https://en.wikipedia.org/wiki/Single-page_application">Aplicaci√≥n de una sola p√°gina (SPA)</a>.</p>
<p>Para enviar los datos del formulario al servidor sin forzar la recarga de una p√°gina, tenemos que usar c√≥digo JavaScript. En lugar de poner una URL en la propiedad <code>action</code> de un elemento <code>&lt;form&gt;</code>, puede usar cualquier c√≥digo JavaScript precedido por la cadena <code>javascript:</code> para realizar una acci√≥n personalizada. Usar esto tambi√©n significa que tendr√° que implementar algunas tareas que anteriormente el navegador realizaba autom√°ticamente:</p>
<ul>
<li>Recuperar los datos del formulario</li>
<li>Convierta y codifique los datos del formulario a un formato adecuado</li>
<li>Crea la solicitud HTTP y env√≠ala al servidor</li>
</ul>
<h3 id="tarea-2">Tarea</h3>
<p>Reemplace el formulario de registro <code>acci√≥n</code> con:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">&lt;form</span><span class="ot"> id=</span><span class="st">&quot;registerForm&quot;</span><span class="ot"> action=</span><span class="st">&quot;javascript:register()&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p>Abra <code>app.js</code> agregue una nueva funci√≥n llamada <code>registro</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">function</span> <span class="at">register</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="kw">const</span> registerForm <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;registerForm&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="kw">const</span> formData <span class="op">=</span> <span class="kw">new</span> <span class="at">FormData</span>(registerForm)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="kw">const</span> data <span class="op">=</span> <span class="va">Object</span>.<span class="at">fromEntries</span>(formData)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-5" title="5">  <span class="kw">const</span> jsonData <span class="op">=</span> <span class="va">JSON</span>.<span class="at">stringify</span>(data)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="op">}</span></a></code></pre></div>
<p>Aqu√≠ recuperamos el elemento del formulario usando <code>getElementById()</code> y usamos el ayudante <a href="https://developer.mozilla.org/docs/Web/API/FormData"><code>FormData</code></a> para extraer los valores del formulario controles como un conjunto de pares clave/valor. Luego convertimos los datos a un objeto regular usando <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries"><code>Object.fromEntries()</code></a> y finalmente serialice los datos en <a href="https://www.json.org/json-en.html">JSON</a>, un formato que se utiliza com√∫nmente para intercambiar datos en la web.</p>
<p>Los datos ahora est√°n listos para enviarse al servidor. Cree una nueva funci√≥n llamada <code>createAccount</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">async</span> <span class="kw">function</span> <span class="at">createAccount</span>(account) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-3" title="3">    <span class="kw">const</span> response <span class="op">=</span> <span class="cf">await</span> <span class="at">fetch</span>(<span class="st">&#39;//localhost:5000/api/accounts&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-4" title="4">      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-5" title="5">      <span class="dt">headers</span><span class="op">:</span> <span class="op">{</span> <span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb8-6" title="6">      <span class="dt">body</span><span class="op">:</span> account</a>
<a class="sourceLine" id="cb8-7" title="7">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-8" title="8">    <span class="cf">return</span> <span class="cf">await</span> <span class="va">response</span>.<span class="at">json</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-9" title="9">  <span class="op">}</span> <span class="cf">catch</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-10" title="10">    <span class="cf">return</span> <span class="op">{</span> <span class="dt">error</span><span class="op">:</span> <span class="va">error</span>.<span class="at">message</span> <span class="op">||</span> <span class="st">&#39;Unknown error&#39;</span> <span class="op">};</span></a>
<a class="sourceLine" id="cb8-11" title="11">  <span class="op">}</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="op">}</span></a></code></pre></div>
<p>¬øQu√© hace esta funci√≥n? Primero, observe la palabra clave <code>async</code> aqu√≠. Esto significa que la funci√≥n contiene c√≥digo que se ejecutar√° <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function">** asincr√≥nicamente**</a>. Cuando se usa junto con la palabra clave <code>await</code>, permite esperar a que se ejecute el c√≥digo asincr√≥nico, como esperar la respuesta del servidor aqu√≠, antes de continuar.</p>
<p>Aqu√≠ hay un video r√°pido sobre el uso de <code>async/await</code>:</p>
<p><a href="https://youtube.com/watch?v=YwmlRkrxvkk" title="Async y Await para administrar promesas"><img src="https://img.youtube.com/vi/YwmlRkrxvkk/0.jpg" alt="Async y Await para administrar promesas" /></a></p>
<p>Usamos la API <code>fetch()</code> para enviar datos JSON al servidor. Este m√©todo toma 2 par√°metros:</p>
<ul>
<li>La URL del servidor, por lo que volvemos a colocar <code>//localhost:5000/api/accounts</code> aqu√≠.</li>
<li>La configuraci√≥n de la solicitud. Ah√≠ es donde establecemos el m√©todo en <code>POST</code> y proporcionamos el <code>body</code> de la solicitud. Como estamos enviando datos JSON al servidor, tambi√©n necesitamos establecer el encabezado <code>Content-Type</code> en <code>application/json</code> para que el servidor sepa c√≥mo interpretar el contenido.</li>
</ul>
<p>Como el servidor responder√° a la solicitud con JSON, podemos usar <code>await response.json()</code> para analizar el contenido JSON y devolver el objeto resultante. Tenga en cuenta que este m√©todo es as√≠ncrono, por lo que usamos la palabra clave <code>await</code> aqu√≠ antes de regresar para asegurarnos de que tambi√©n se detecta cualquier error durante el an√°lisis.</p>
<p>Ahora agregue un c√≥digo a la funci√≥n <code>register</code> para llamar a <code>createAccount()</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> <span class="at">createAccount</span>(jsonData)<span class="op">;</span></a></code></pre></div>
<p>Debido a que usamos la palabra clave <code>await</code> aqu√≠, necesitamos agregar la palabra clave <code>async</code> antes de la funci√≥n de registro:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">async</span> <span class="kw">function</span> <span class="at">register</span>() <span class="op">{</span></a></code></pre></div>
<p>Finalmente, agreguemos algunos registros para verificar el resultado. La funci√≥n final deber√≠a verse as√≠:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">async</span> <span class="kw">function</span> <span class="at">register</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="kw">const</span> registerForm <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;registerForm&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="kw">const</span> formData <span class="op">=</span> <span class="kw">new</span> <span class="at">FormData</span>(registerForm)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="kw">const</span> jsonData <span class="op">=</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="va">Object</span>.<span class="at">fromEntries</span>(formData))<span class="op">;</span></a>
<a class="sourceLine" id="cb11-5" title="5">  <span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> <span class="at">createAccount</span>(jsonData)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-6" title="6"></a>
<a class="sourceLine" id="cb11-7" title="7">  <span class="cf">if</span> (<span class="va">result</span>.<span class="at">error</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb11-8" title="8">    <span class="cf">return</span> <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;An error occured:&#39;</span><span class="op">,</span> <span class="va">result</span>.<span class="at">error</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-9" title="9">  <span class="op">}</span></a>
<a class="sourceLine" id="cb11-10" title="10"></a>
<a class="sourceLine" id="cb11-11" title="11">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Account created!&#39;</span><span class="op">,</span> result)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="op">}</span></a></code></pre></div>
<p>¬°Eso fue un poco largo pero llegamos all√≠! Si abre sus <a href="https://developer.mozilla.org/docs/Learn/Common_questions/What_are_browser_developer_tools">herramientas de desarrollo del navegador</a> e intenta registrar una nueva cuenta, no deber√≠a ver ning√∫n cambio en la p√°gina web pero aparecer√° un mensaje en la consola confirmando que todo funciona.</p>
<figure>
<img src="./images/browser-console.png" alt="Captura de pantalla que muestra el mensaje de registro en la consola del navegador" /><figcaption>Captura de pantalla que muestra el mensaje de registro en la consola del navegador</figcaption>
</figure>
<p>‚úÖ ¬øCrees que los datos se env√≠an al servidor de forma segura? ¬øY si alguien pudiera interceptar la solicitud? Puede leer sobre <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a> para saber m√°s sobre la comunicaci√≥n segura de datos.</p>
<h2 id="validaci√≥n-de-datos">Validaci√≥n de datos</h2>
<p>Si intenta registrar una nueva cuenta sin establecer un nombre de usuario primero, puede ver que el servidor devuelve un error con el c√≥digo de estado <a href="https://developer.mozilla.org/docs/Web/HTTP/Status/400#:~:text=The%20HyperText%20Transfer%20Protocol%20(HTTP,%2C%20or%20deceptive%20request%20routing).">400 (Solicitud incorrecta)</a>.</p>
<p>Antes de enviar datos a un servidor, es una buena pr√°ctica <a href="https://developer.mozilla.org/docs/Learn/Forms/Form_validation">validar los datos del formulario</a> de antemano cuando sea posible, para asegurarse de enviar un solicitud v√°lida. Los controles de formularios HTML5 proporcionan una validaci√≥n incorporada utilizando varios atributos:</p>
<ul>
<li><code>required</code>: el campo debe completarse; de ‚Äã‚Äãlo contrario, el formulario no se podr√° enviar</li>
<li><code>minlength</code> y <code>maxlength</code>: define el n√∫mero m√≠nimo y m√°ximo de caracteres en los campos de texto.</li>
<li><code>min</code> y <code>max</code>: define el valor m√≠nimo y m√°ximo de un campo num√©rico.</li>
<li><code>type</code>: define el tipo de datos esperados, como <code>number</code>, <code>email</code>, <code>file</code> u <a href="https://developer.mozilla.org/docs/Web/HTML/Element/input">otros tipos integrados</a>. Este atributo tambi√©n puede cambiar la representaci√≥n visual del control de formulario.</li>
<li><code>patr√≥n</code>: permite definir un patr√≥n <a href="https://developer.mozilla.org/docs/Web/JavaScript/Guide/Regular_Expressions">expresi√≥n regular</a> para probar si los datos ingresados ‚Äã‚Äãson v√°lidos o no.</li>
</ul>
<blockquote>
<p>Consejo: puedes personalizar el aspecto de los controles de tu formulario dependiendo de si son v√°lidos o no usando las pseudoclases CSS <code>:valid</code> y <code>:invalid</code>.</p>
</blockquote>
<h3 id="tarea-3">Tarea</h3>
<p>Hay 2 campos obligatorios para crear una nueva cuenta v√°lida, el nombre de usuario y la moneda, los otros campos son opcionales. Actualice el formulario en HTML para reflejar que:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;user&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> required</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb12-2" title="2">...</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;currency&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;$&quot;</span><span class="ot"> required</span><span class="kw">&gt;</span></a></code></pre></div>
<p>Si bien esta implementaci√≥n de servidor en particular no impone l√≠mites espec√≠ficos en la longitud m√°xima de los campos, siempre es una buena pr√°ctica definir l√≠mites razonables para cualquier entrada de texto del usuario.</p>
<p>Agrega un atributo <code>maxlength</code> a los campos de texto:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;user&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> maxlength=</span><span class="st">&quot;20&quot;</span><span class="ot"> required</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb13-2" title="2">...</a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;currency&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;$&quot;</span><span class="ot"> maxlength=</span><span class="st">&quot;5&quot;</span><span class="ot"> required</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb13-4" title="4">...</a>
<a class="sourceLine" id="cb13-5" title="5"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;description&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> maxlength=</span><span class="st">&quot;100&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p>Ahora, si presiona el bot√≥n <em>Registrar</em> y un campo no respeta una regla de validaci√≥n que definimos, deber√≠a ver algo como esto:</p>
<figure>
<img src="./images/validation-error.png" alt="Captura de pantalla que muestra el error de validaci√≥n al intentar enviar el formulario" /><figcaption>Captura de pantalla que muestra el error de validaci√≥n al intentar enviar el formulario</figcaption>
</figure>
<p>Una validaci√≥n como esta realizada <em>antes</em> de enviar cualquier dato al servidor se llama validaci√≥n <strong>del lado del cliente</strong>. Pero tenga en cuenta que no siempre es posible realizar todas las comprobaciones sin enviar los datos. Por ejemplo, no podemos comprobar aqu√≠ si ya existe una cuenta con el mismo nombre de usuario sin enviar una solicitud al servidor. La validaci√≥n adicional realizada en el servidor se denomina validaci√≥n <strong>del lado del servidor</strong>.</p>
<p>Por lo general, ambos deben implementarse y, si bien el uso de la validaci√≥n del lado del cliente mejora la experiencia del usuario al proporcionar comentarios instant√°neos al usuario, la validaci√≥n del lado del servidor es crucial para garantizar que los datos del usuario que manipula sean s√≥lidos y seguros.</p>
<hr />
<h2 id="desaf√≠o">üöÄ Desaf√≠o</h2>
<p>Muestra un mensaje de error en el HTML si el usuario ya existe.</p>
<p>Aqu√≠ hay un ejemplo de c√≥mo puede verse la p√°gina de inicio de sesi√≥n final despu√©s de un poco de estilo:</p>
<figure>
<img src="./images/result.png" alt="Captura de pantalla de la p√°gina de inicio de sesi√≥n despu√©s de agregar estilos CSS" /><figcaption>Captura de pantalla de la p√°gina de inicio de sesi√≥n despu√©s de agregar estilos CSS</figcaption>
</figure>
<h2 id="prueba-posterior-a-la-conferencia"><a href="https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/44">Prueba posterior a la conferencia</a></h2>
<h2 id="revisi√≥n-y-autoestudio">Revisi√≥n y autoestudio</h2>
<p>Los desarrolladores se han vuelto muy creativos en sus esfuerzos de creaci√≥n de formularios, especialmente en lo que respecta a las estrategias de validaci√≥n. Obtenga informaci√≥n sobre los diferentes flujos de formularios consultando <a href="https://codepen.com">CodePen</a>; ¬øPuedes encontrar algunas formas interesantes e inspiradoras?</p>
<h2 id="asignaci√≥n">Asignaci√≥n</h2>
<p><a href="assignment.es.md">Dise√±a tu aplicaci√≥n bancaria</a></p>
</body>
</html>
